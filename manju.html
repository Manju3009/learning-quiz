<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>ExamEdge Pro â€” Competitive Exam Quiz Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#070711;--bg2:#0c0c1a;--card:#111120;--card2:#161628;--card3:#1c1c35;
  --b1:rgba(255,255,255,.06);--b2:rgba(255,255,255,.11);--b3:rgba(255,255,255,.18);
  --acc:#5b6af0;--acc2:#7c8bf5;--acc3:#a5aefa;
  --grad:linear-gradient(135deg,#5b6af0 0%,#8b5cf6 100%);
  --glow:0 0 40px rgba(91,106,240,.3);
  --green:#10d97e;--red:#ff4d6d;--amber:#fbbf24;--sky:#38bdf8;--pink:#f472b6;
  --easy:#10d97e;--mid:#fbbf24;--hard:#ff4d6d;
  --text:#eeeeff;--sub:#8888bb;--muted:#44446a;
  --r:16px;--r2:12px;--r3:8px;
  --font:'Outfit',sans-serif;
  --mono:'JetBrains Mono',monospace;
}
html{scroll-behavior:smooth}
body{font-family:var(--font);background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}

/* animated mesh bg */
.mesh{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
.mesh span{position:absolute;border-radius:50%;filter:blur(80px);animation:drift 18s ease-in-out infinite alternate}
.mesh span:nth-child(1){width:600px;height:600px;background:rgba(91,106,240,.10);top:-200px;left:-150px;animation-delay:0s}
.mesh span:nth-child(2){width:500px;height:500px;background:rgba(139,92,246,.08);bottom:-180px;right:-120px;animation-delay:-6s}
.mesh span:nth-child(3){width:350px;height:350px;background:rgba(56,189,248,.06);top:40%;left:55%;animation-delay:-12s}
@keyframes drift{from{transform:translate(0,0) scale(1)}to{transform:translate(40px,30px) scale(1.08)}}

/* â”€â”€ APP SHELL â”€â”€ */
.app{position:relative;z-index:1;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:0 1rem 5rem}
.wrap{width:100%;max-width:900px}

/* â”€â”€ TOPBAR â”€â”€ */
.topbar{display:flex;align-items:center;justify-content:space-between;padding:1.4rem 0;width:100%;max-width:900px}
.logo-row{display:flex;align-items:center;gap:.75rem}
.logo-mark{width:44px;height:44px;border-radius:13px;background:var(--grad);display:flex;align-items:center;justify-content:center;font-size:1.3rem;box-shadow:var(--glow)}
.logo-text{font-weight:900;font-size:1.4rem;letter-spacing:-.02em}
.logo-text em{font-style:normal;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.logo-sub{font-size:.6rem;color:var(--sub);text-transform:uppercase;letter-spacing:.12em;margin-top:-3px}
.hud{display:none;align-items:center;gap:.6rem}
.hud.show{display:flex}
.hud-chip{display:flex;align-items:center;gap:.35rem;background:var(--card2);border:1px solid var(--b2);border-radius:20px;padding:.3rem .85rem;font-size:.76rem;font-weight:600}
.hud-chip.pts{color:var(--acc3)}
.hud-chip.usr{color:var(--green)}
.hud-logout{background:transparent;border:1px solid var(--b2);border-radius:8px;padding:.3rem .7rem;font-size:.72rem;color:var(--sub);cursor:pointer;font-family:var(--font);transition:all .2s}
.hud-logout:hover{border-color:var(--red);color:var(--red)}

/* â”€â”€ SCREENS â”€â”€ */
.screen{display:none;animation:screenIn .4s cubic-bezier(.22,.68,0,1.2) both}
.screen.active{display:block}
@keyframes screenIn{from{opacity:0;transform:translateY(24px) scale(.98)}to{opacity:1;transform:translateY(0) scale(1)}}

/* â”€â”€ PANEL / CARD â”€â”€ */
.panel{background:var(--card);border:1px solid var(--b1);border-radius:var(--r);padding:2.5rem;position:relative;overflow:hidden}
.panel::after{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(91,106,240,.6),transparent)}
.panel-sm{padding:1.6rem}

/* â”€â”€ TYPOGRAPHY â”€â”€ */
.page-title{font-weight:900;font-size:clamp(1.6rem,4vw,2.1rem);letter-spacing:-.03em;line-height:1.15;margin-bottom:.3rem}
.page-title em{font-style:normal;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.page-sub{font-size:.88rem;color:var(--sub);margin-bottom:2rem;line-height:1.6}
.section-label{font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:.12em;color:var(--sub);margin-bottom:.9rem}

/* â”€â”€ BUTTONS â”€â”€ */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:.45rem;font-family:var(--font);font-weight:700;border:none;cursor:pointer;border-radius:var(--r2);transition:all .2s cubic-bezier(.25,.8,.25,1);user-select:none}
.btn:disabled{opacity:.3;cursor:not-allowed;pointer-events:none}
.btn-primary{background:var(--grad);color:#fff;padding:.9rem 2rem;font-size:.92rem;box-shadow:0 4px 20px rgba(91,106,240,.35)}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 32px rgba(91,106,240,.5)}
.btn-outline{background:var(--card2);color:var(--sub);border:1.5px solid var(--b2);padding:.8rem 1.4rem;font-size:.88rem}
.btn-outline:hover{border-color:var(--acc2);color:var(--acc3)}
.btn-ghost{background:transparent;color:var(--muted);border:1.5px dashed var(--b2);padding:.75rem 1.2rem;font-size:.82rem}
.btn-ghost:hover{border-color:var(--amber);color:var(--amber)}
.btn-danger{background:rgba(255,77,109,.12);color:var(--red);border:1.5px solid rgba(255,77,109,.3);padding:.8rem 1.4rem;font-size:.88rem}
.btn-danger:hover{background:rgba(255,77,109,.22);border-color:var(--red)}
.btn-full{width:100%}
.btn-row{display:flex;gap:.75rem;align-items:center;flex-wrap:wrap}

/* â”€â”€ INPUT â”€â”€ */
.field{margin-bottom:1.3rem}
.field label{display:block;font-size:.76rem;font-weight:700;color:var(--sub);text-transform:uppercase;letter-spacing:.1em;margin-bottom:.5rem}
.field input,.field select{width:100%;background:var(--card2);border:1.5px solid var(--b2);border-radius:var(--r2);padding:.85rem 1.1rem;font-family:var(--font);font-size:.92rem;color:var(--text);outline:none;transition:border-color .2s}
.field input:focus,.field select:focus{border-color:var(--acc2);box-shadow:0 0 0 3px rgba(91,106,240,.15)}
.field input::placeholder{color:var(--muted)}
.field .input-wrap{position:relative}
.field .input-icon{position:absolute;right:1rem;top:50%;transform:translateY(-50%);font-size:1.1rem;cursor:pointer;user-select:none}
.field-error{font-size:.72rem;color:var(--red);margin-top:.35rem;display:none}
.field-error.show{display:block}

/* â”€â”€ LOGIN â”€â”€ */
#s-login{padding-top:5vh}
.login-box{max-width:440px;margin:0 auto}
.login-hero{text-align:center;margin-bottom:2rem}
.login-hero .hero-icon{font-size:3rem;margin-bottom:.75rem}
.auth-tabs{display:flex;background:var(--card2);border-radius:var(--r2);padding:.25rem;margin-bottom:1.8rem;gap:.25rem}
.auth-tab{flex:1;padding:.65rem;border-radius:var(--r3);font-size:.84rem;font-weight:700;background:transparent;border:none;color:var(--sub);cursor:pointer;font-family:var(--font);transition:all .2s}
.auth-tab.active{background:var(--acc);color:#fff;box-shadow:0 2px 10px rgba(91,106,240,.4)}
.form-section{display:none}
.form-section.active{display:block}
.divider{display:flex;align-items:center;gap:.8rem;margin:1rem 0;color:var(--muted);font-size:.72rem}
.divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--b2)}
.demo-row{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.75rem}
.demo-chip{background:var(--card3);border:1px solid var(--b2);border-radius:8px;padding:.35rem .75rem;font-size:.7rem;color:var(--sub);cursor:pointer;transition:all .2s}
.demo-chip:hover{border-color:var(--acc2);color:var(--acc3)}

/* â”€â”€ DASHBOARD â”€â”€ */
.dash-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1.5rem}
.dash-stat{background:var(--card2);border:1px solid var(--b1);border-radius:var(--r2);padding:1.2rem 1.4rem;display:flex;align-items:center;gap:.9rem}
.ds-icon{width:46px;height:46px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.3rem;flex-shrink:0}
.ds-val{font-weight:900;font-size:1.55rem;line-height:1;font-family:var(--mono)}
.ds-lbl{font-size:.68rem;color:var(--sub);text-transform:uppercase;letter-spacing:.08em;margin-top:.15rem}
.exam-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:.75rem;margin-bottom:1.5rem}
.exam-card{background:var(--card2);border:1.5px solid var(--b1);border-radius:var(--r2);padding:1.3rem 1.1rem;cursor:pointer;transition:all .22s cubic-bezier(.25,.8,.25,1);position:relative;overflow:hidden;text-align:left;user-select:none}
.exam-card::before{content:'';position:absolute;inset:0;opacity:0;transition:opacity .22s}
.exam-card:hover{border-color:var(--acc2);transform:translateY(-3px);box-shadow:0 10px 24px rgba(0,0,0,.4)}
.exam-card:hover::before{opacity:1}
.exam-card.selected{border-color:var(--acc);background:rgba(91,106,240,.1);box-shadow:0 0 0 3px rgba(91,106,240,.15)}
.exam-card .ec-check{position:absolute;top:9px;right:9px;width:20px;height:20px;border-radius:50%;background:var(--acc);display:none;align-items:center;justify-content:center;font-size:.6rem;font-weight:900;color:#fff;box-shadow:0 0 10px rgba(91,106,240,.5)}
.exam-card.selected .ec-check{display:flex}
.ec-badge{display:inline-flex;align-items:center;gap:.3rem;font-size:.58rem;font-weight:800;text-transform:uppercase;letter-spacing:.1em;padding:.18rem .55rem;border-radius:20px;margin-bottom:.65rem}
.ec-icon{font-size:1.7rem;display:block;margin-bottom:.5rem}
.ec-name{font-weight:800;font-size:.92rem;margin-bottom:.2rem}
.ec-info{font-size:.66rem;color:var(--sub)}

/* exam badge colours */
.eb-tnpsc{background:rgba(16,217,126,.12);border:1px solid rgba(16,217,126,.3);color:var(--easy)}
.eb-ssc{background:rgba(91,106,240,.12);border:1px solid rgba(91,106,240,.3);color:var(--acc3)}
.eb-rrb{background:rgba(251,191,36,.12);border:1px solid rgba(251,191,36,.3);color:var(--amber)}
.eb-bank{background:rgba(56,189,248,.12);border:1px solid rgba(56,189,248,.3);color:var(--sky)}
.eb-upsc{background:rgba(244,114,182,.12);border:1px solid rgba(244,114,182,.3);color:var(--pink)}
.eb-ese{background:rgba(255,77,109,.12);border:1px solid rgba(255,77,109,.3);color:var(--red)}
.eb-gate{background:rgba(139,92,246,.12);border:1px solid rgba(139,92,246,.3);color:#c084fc}
.eb-ugc{background:rgba(234,179,8,.12);border:1px solid rgba(234,179,8,.3);color:#eab308}

/* â”€â”€ RECENT HISTORY â”€â”€ */
.history-list{display:flex;flex-direction:column;gap:.5rem}
.hist-item{background:var(--card2);border:1px solid var(--b1);border-radius:var(--r2);padding:.85rem 1.1rem;display:flex;align-items:center;gap:.9rem}
.hi-icon{font-size:1.2rem;width:36px;text-align:center}
.hi-info{flex:1}
.hi-name{font-weight:700;font-size:.85rem}
.hi-meta{font-size:.68rem;color:var(--sub);margin-top:.1rem}
.hi-score{font-weight:900;font-size:.95rem;font-family:var(--mono)}
.hi-score.good{color:var(--green)}.hi-score.avg{color:var(--amber)}.hi-score.poor{color:var(--red)}
.empty-state{text-align:center;padding:2rem;color:var(--muted);font-size:.85rem}

/* â”€â”€ SETUP SCREEN â”€â”€ */
.setup-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1.2rem}
.diff-cards{display:grid;grid-template-columns:repeat(3,1fr);gap:.75rem;margin-bottom:1.5rem}
.diff-card{background:var(--card2);border:2px solid var(--b1);border-radius:var(--r2);padding:1.4rem .9rem;text-align:center;cursor:pointer;user-select:none;transition:all .2s;position:relative}
.diff-card .dc-check{position:absolute;top:8px;right:8px;width:18px;height:18px;border-radius:50%;display:none;align-items:center;justify-content:center;font-size:.55rem;font-weight:900;color:#000}
.diff-card.picked .dc-check{display:flex}
.diff-card.easy:hover,.diff-card.easy.picked{border-color:var(--easy);background:rgba(16,217,126,.08);box-shadow:0 6px 22px rgba(16,217,126,.15)}
.diff-card.mid:hover,.diff-card.mid.picked{border-color:var(--mid);background:rgba(251,191,36,.08);box-shadow:0 6px 22px rgba(251,191,36,.15)}
.diff-card.hard:hover,.diff-card.hard.picked{border-color:var(--hard);background:rgba(255,77,109,.08);box-shadow:0 6px 22px rgba(255,77,109,.15)}
.diff-card.easy .dc-check{background:var(--easy)}
.diff-card.mid  .dc-check{background:var(--mid)}
.diff-card.hard .dc-check{background:var(--hard)}
.dc-icon{font-size:2rem;margin-bottom:.5rem}
.dc-label{font-weight:800;font-size:.95rem}
.diff-card.easy .dc-label{color:var(--easy)}.diff-card.mid .dc-label{color:var(--mid)}.diff-card.hard .dc-label{color:var(--hard)}
.dc-pts{font-size:.65rem;color:var(--sub);margin-top:.3rem}
.qcount-row{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1.5rem}
.qc-btn{padding:.45rem 1.1rem;border-radius:20px;cursor:pointer;user-select:none;border:1.5px solid var(--b2);background:var(--card2);font-family:var(--font);font-weight:700;font-size:.8rem;color:var(--sub);transition:all .18s}
.qc-btn:hover{border-color:var(--acc2);color:var(--acc3)}
.qc-btn.active{background:var(--acc);border-color:var(--acc);color:#fff;box-shadow:0 2px 12px rgba(91,106,240,.4)}
.timer-config{background:var(--card2);border:1px solid var(--b2);border-radius:var(--r2);padding:1.4rem;margin-bottom:1.5rem}
.tc-header{display:flex;align-items:center;gap:.5rem;font-weight:700;font-size:.9rem;margin-bottom:1rem}
.timer-presets{display:flex;flex-wrap:wrap;gap:.45rem;margin-bottom:.9rem}
.tp-btn{padding:.38rem .85rem;border-radius:20px;cursor:pointer;user-select:none;border:1.5px solid var(--b2);background:var(--card);font-family:var(--font);font-weight:700;font-size:.75rem;color:var(--sub);transition:all .18s}
.tp-btn:hover{border-color:var(--acc2);color:var(--acc3)}
.tp-btn.active{background:var(--acc);border-color:var(--acc);color:#fff}
.custom-row{display:flex;align-items:center;gap:.9rem}
.custom-row label{font-size:.75rem;color:var(--sub);font-weight:700;white-space:nowrap}
input[type=range]{
  -webkit-appearance:none;
  appearance:none;          /* Standard property */
  flex:1;
  height:5px;
  background:var(--card);
  border-radius:5px;
  outline:none;
  cursor:pointer;
}
input[type=range]::-webkit-slider-thumb>{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--acc);cursor:pointer;box-shadow:0 0 8px rgba(91,106,240,.4)}
.tval{min-width:68px;background:var(--card);border:1.5px solid var(--acc);border-radius:8px;padding:.28rem .75rem;text-align:center;font-weight:900;font-size:.95rem;color:var(--acc3);font-family:var(--mono)}
.preview-box{background:var(--card2);border:1px solid var(--b2);border-radius:var(--r2);padding:1rem 1.3rem;margin-bottom:1.5rem}
.prev-row{display:flex;flex-wrap:wrap;gap:1.2rem;font-size:.78rem}
.prev-item strong{color:var(--acc3)}

/* â”€â”€ QUIZ SCREEN â”€â”€ */
.quiz-header{display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap;margin-bottom:.9rem}
.qh-left{display:flex;align-items:center;gap:.6rem;flex-wrap:wrap}
.qh-pill{display:flex;align-items:center;gap:.3rem;background:var(--card2);border:1px solid var(--b2);border-radius:20px;padding:.25rem .75rem;font-size:.7rem;font-weight:700}
.qh-right{display:flex;gap:.5rem}
.qstat{display:flex;align-items:center;gap:.3rem;background:var(--card2);border:1px solid var(--b2);border-radius:10px;padding:.28rem .7rem;font-size:.78rem;font-weight:800}
.qstat.s-pts{color:var(--acc3)}.qstat.s-stk{color:var(--amber)}.qstat.s-stk.hidden{display:none}
.timer-bar-wrap{margin-bottom:.85rem}
.tbar-top{display:flex;align-items:center;gap:.9rem;margin-bottom:.4rem}
.tbar-track{flex:1;height:9px;background:var(--card2);border-radius:9px;overflow:hidden;position:relative}
.tbar-fill{height:100%;border-radius:9px;background:linear-gradient(90deg,var(--green),#4ade80);transition:width 1s linear,background .4s}
.tbar-fill.warn{background:linear-gradient(90deg,var(--amber),#fde68a)}
.tbar-fill.danger{background:linear-gradient(90deg,var(--red),#fb7185);animation:pulse-bar .5s ease infinite alternate}
@keyframes pulse-bar{to{opacity:.55}}
.timer-box{flex-shrink:0;width:56px;height:56px;border-radius:12px;background:var(--card2);border:2px solid var(--b2);display:flex;flex-direction:column;align-items:center;justify-content:center;transition:border-color .3s}
.timer-box .tn{font-family:var(--mono);font-weight:700;font-size:1.3rem;line-height:1}
.timer-box .tl{font-size:.44rem;color:var(--sub);text-transform:uppercase;letter-spacing:.06em}
.timer-box.warn{border-color:var(--amber);color:var(--amber)}.timer-box.warn .tl{color:var(--amber)}
.timer-box.danger{border-color:var(--red);color:var(--red);animation:tshake .35s ease infinite}.timer-box.danger .tl{color:var(--red)}
@keyframes tshake{0%,100%{transform:rotate(0)}30%{transform:rotate(-3deg)}70%{transform:rotate(3deg)}}
.prog-wrap{margin-bottom:1rem}
.prog-meta{display:flex;justify-content:space-between;font-size:.72rem;color:var(--sub);font-weight:600;margin-bottom:.4rem}
.prog-meta .frac{color:var(--text);font-weight:800}
.prog-track{height:5px;background:var(--card2);border-radius:5px;overflow:hidden}
.prog-bar{height:100%;border-radius:5px;background:var(--grad);transition:width .5s cubic-bezier(.4,0,.2,1)}
.dot-nav{display:flex;flex-wrap:wrap;gap:.3rem;margin-top:.55rem}
.dn-dot{width:9px;height:9px;border-radius:50%;background:var(--card2);border:1.5px solid var(--b2);cursor:pointer;transition:all .22s}
.dn-dot:hover{transform:scale(1.5);border-color:var(--acc2)}
.dn-dot.cur{background:var(--acc);border-color:var(--acc);transform:scale(1.5);box-shadow:0 0 7px rgba(91,106,240,.5)}
.dn-dot.ok{background:var(--green);border-color:var(--green)}
.dn-dot.bad{background:var(--red);border-color:var(--red)}
.dn-dot.skip{background:var(--muted);border-color:var(--muted)}

/* question card */
.q-card{background:var(--card2);border:1px solid var(--b2);border-radius:var(--r2);padding:1.6rem 1.8rem;margin-bottom:.9rem}
.q-tags{display:flex;align-items:center;gap:.5rem;margin-bottom:.75rem;flex-wrap:wrap}
.qtag{display:inline-flex;align-items:center;gap:.25rem;padding:.18rem .65rem;border-radius:20px;font-size:.6rem;font-weight:800;text-transform:uppercase;letter-spacing:.08em}
.qtag-diff.easy{background:rgba(16,217,126,.12);border:1px solid rgba(16,217,126,.25);color:var(--easy)}
.qtag-diff.mid{background:rgba(251,191,36,.12);border:1px solid rgba(251,191,36,.25);color:var(--amber)}
.qtag-diff.hard{background:rgba(255,77,109,.12);border:1px solid rgba(255,77,109,.25);color:var(--red)}
.qtag-cat{background:rgba(91,106,240,.12);border:1px solid rgba(91,106,240,.25);color:var(--acc3)}
.q-num{font-size:.66rem;color:var(--muted);font-weight:700;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.45rem}
.q-text{font-weight:700;font-size:clamp(.97rem,2.5vw,1.15rem);line-height:1.6;color:var(--text)}
.multi-note{display:inline-flex;align-items:center;gap:.3rem;margin-top:.6rem;background:rgba(251,191,36,.1);border:1px solid rgba(251,191,36,.25);border-radius:8px;padding:.3rem .7rem;font-size:.68rem;color:var(--amber);font-weight:600}

/* options */
.opts{display:flex;flex-direction:column;gap:.55rem;margin-bottom:.9rem}
.opt{background:var(--card2);border:1.5px solid var(--b1);border-radius:var(--r2);padding:.85rem 1.1rem;cursor:pointer;user-select:none;display:flex;align-items:flex-start;gap:.8rem;transition:all .18s cubic-bezier(.25,.8,.25,1);position:relative;overflow:hidden}
.opt:hover:not(:disabled):not(.locked){border-color:rgba(91,106,240,.5);background:rgba(91,106,240,.06);transform:translateX(3px)}
.opt.sel:not(.revealed){border-color:var(--acc);background:rgba(91,106,240,.12)}
.opt.correct{border-color:var(--green)!important;background:rgba(16,217,126,.1)!important;animation:popIn .35s ease}
.opt.wrong{border-color:var(--red)!important;background:rgba(255,77,109,.1)!important;animation:shakeX .3s ease}
.opt.locked{cursor:default}
@keyframes popIn{0%{transform:scale(1)}50%{transform:scale(1.015)}100%{transform:scale(1)}}
@keyframes shakeX{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-4px)}40%,80%{transform:translateX(4px)}}
.opt-key{width:28px;height:28px;border-radius:7px;flex-shrink:0;background:var(--card3);border:1.5px solid var(--b2);display:flex;align-items:center;justify-content:center;font-size:.7rem;font-weight:800;color:var(--sub);transition:all .18s;margin-top:.05rem}
.opt.sel:not(.revealed) .opt-key{background:var(--acc);border-color:var(--acc);color:#fff}
.opt.correct .opt-key{background:var(--green);border-color:var(--green);color:#000}
.opt.wrong   .opt-key{background:var(--red);  border-color:var(--red);  color:#fff}
.opt-txt{flex:1;font-size:.9rem;font-weight:500;line-height:1.45}
.opt-ic{margin-left:auto;font-size:1rem;flex-shrink:0;display:none;margin-top:.05rem}
.opt.correct .opt-ic,.opt.wrong .opt-ic{display:block}

/* feedback */
.feedback{border-radius:var(--r2);padding:.85rem 1.1rem;display:none;align-items:flex-start;gap:.65rem;font-size:.84rem;font-weight:600;margin-bottom:.9rem}
.feedback.show{display:flex}
.feedback.ok{background:rgba(16,217,126,.1);border:1px solid rgba(16,217,126,.25);color:var(--green)}
.feedback.bad{background:rgba(255,77,109,.1);border:1px solid rgba(255,77,109,.25);color:var(--red)}
.feedback.skip{background:rgba(68,68,106,.15);border:1px solid rgba(68,68,106,.3);color:var(--muted)}
.feedback.timeout{background:rgba(251,191,36,.1);border:1px solid rgba(251,191,36,.25);color:var(--amber)}
.fb-icon{font-size:1.1rem;flex-shrink:0;margin-top:.05rem}
.fb-body strong{font-weight:800}

/* explanation box */
.explain-box{display:none;background:var(--card3);border:1px solid var(--b2);border-left:3px solid var(--acc2);border-radius:var(--r2);padding:1rem 1.2rem;margin-bottom:.9rem;font-size:.83rem;line-height:1.65;color:var(--sub)}
.explain-box.show{display:block}
.explain-box .ex-title{font-weight:800;color:var(--acc3);font-size:.75rem;text-transform:uppercase;letter-spacing:.1em;margin-bottom:.4rem;display:flex;align-items:center;gap:.35rem}

/* quiz nav */
.quiz-nav{display:flex;gap:.65rem;align-items:center}

/* â”€â”€ STREAK TOAST â”€â”€ */
.streak-toast{position:fixed;top:76px;left:50%;transform:translateX(-50%) translateY(-14px);background:linear-gradient(135deg,var(--amber),#f97316);color:#000;font-weight:800;font-size:.92rem;border-radius:30px;padding:.5rem 1.5rem;box-shadow:0 8px 28px rgba(251,191,36,.4);z-index:999;opacity:0;pointer-events:none;transition:all .3s cubic-bezier(.25,.8,.25,1);white-space:nowrap}
.streak-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* â”€â”€ RESULTS â”€â”€ */
.result-hero{text-align:center;padding:1.2rem 0 .5rem}
.rh-emoji{font-size:3.2rem;animation:heroIn .6s cubic-bezier(.25,.8,.25,1) both}
@keyframes heroIn{0%{transform:scale(0) rotate(-15deg)}65%{transform:scale(1.12) rotate(5deg)}100%{transform:scale(1) rotate(0)}}
.rh-title{font-weight:900;font-size:1.8rem;letter-spacing:-.03em;margin:.5rem 0 .25rem}
.rh-title em{font-style:normal;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.rh-sub{font-size:.84rem;color:var(--sub)}

/* ring */
.ring-wrap{position:relative;display:inline-block;margin:1rem 0}
.ring-svg{transform:rotate(-90deg);filter:drop-shadow(0 0 16px rgba(91,106,240,.35))}
.ring-bg{fill:none;stroke:var(--card2);stroke-width:11}
.ring-fg{fill:none;stroke-width:11;stroke-linecap:round;transition:stroke-dashoffset 1.5s cubic-bezier(.4,0,.2,1)}
.ring-center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.ring-pct{font-family:var(--mono);font-weight:700;font-size:2rem;line-height:1}
.ring-lbl{font-size:.55rem;color:var(--sub);text-transform:uppercase;letter-spacing:.1em}

/* stat boxes */
.stat-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:.65rem;margin:1rem 0}
.sbox{background:var(--card2);border:1px solid var(--b1);border-radius:var(--r2);padding:.9rem .5rem;text-align:center}
.sbox .sv{font-family:var(--mono);font-weight:700;font-size:1.55rem;margin-bottom:.15rem;line-height:1}
.sbox .sl{font-size:.58rem;color:var(--sub);text-transform:uppercase;letter-spacing:.08em}
.sbox.sv-ok .sv{color:var(--green)}.sbox.sv-bad .sv{color:var(--red)}.sbox.sv-skip .sv{color:var(--muted)}.sbox.sv-pts .sv{color:var(--acc3)}

/* breakdown */
.bd-list{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1.3rem}
.bd-row{background:var(--card2);border:1px solid var(--b1);border-radius:var(--r2);padding:.7rem 1rem;display:flex;align-items:center;gap:.8rem}
.bd-icon{font-size:1rem;width:30px;text-align:center}
.bd-info{flex:1;min-width:0}
.bd-name{font-weight:700;font-size:.83rem;margin-bottom:.25rem}
.bd-bar{height:4px;background:var(--b1);border-radius:4px;overflow:hidden}
.bd-fill{height:100%;border-radius:4px;transition:width 1.1s cubic-bezier(.4,0,.2,1)}
.bd-score{font-weight:800;font-size:.82rem;color:var(--acc3);white-space:nowrap;font-family:var(--mono)}

/* accuracy bar */
.acc-bar-wrap{margin:.5rem 0 1.2rem}
.acc-labels{display:flex;justify-content:space-between;font-size:.7rem;color:var(--sub);font-weight:600;margin-bottom:.35rem}
.acc-labels strong{color:var(--text)}
.acc-track{height:8px;background:var(--card2);border-radius:8px;overflow:hidden}
.acc-fill{height:100%;border-radius:8px;background:linear-gradient(90deg,var(--green),var(--acc));transition:width 1.3s cubic-bezier(.4,0,.2,1)}

/* review */
.review-hdr{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--b1);padding-bottom:.65rem;margin-bottom:.75rem;cursor:pointer;user-select:none}
.rh-ttl{font-weight:800;font-size:.9rem;color:var(--sub)}
.rh-ico{color:var(--muted);font-size:.75rem;transition:transform .3s}
.review-hdr.open .rh-ico{transform:rotate(180deg)}
.review-items{display:none;flex-direction:column;gap:.5rem;margin-bottom:1.4rem}
.review-items.open{display:flex}
.rv{background:var(--card2);border:1px solid var(--b1);border-left:3px solid;border-radius:var(--r2);padding:.75rem 1rem}
.rv.ok{border-left-color:var(--green)}.rv.bad{border-left-color:var(--red)}.rv.skip{border-left-color:var(--muted)}
.rv-top{display:flex;gap:.5rem;align-items:center;margin-bottom:.3rem;flex-wrap:wrap}
.rv-badge{font-size:.6rem;font-weight:800;padding:.15rem .55rem;border-radius:20px}
.rv.ok   .rv-badge{background:rgba(16,217,126,.12);color:var(--green)}
.rv.bad  .rv-badge{background:rgba(255,77,109,.12);color:var(--red)}
.rv.skip .rv-badge{background:rgba(68,68,106,.15);color:var(--muted)}
.rv-meta{font-size:.63rem;color:var(--muted)}
.rv-q{font-size:.83rem;font-weight:600;margin-bottom:.25rem;line-height:1.45}
.rv-ans{font-size:.75rem;color:var(--sub);margin-bottom:.3rem}
.rv-ans .ca{color:var(--green);font-weight:700}.rv-ans .wa{color:var(--red);font-weight:700}
.rv-explain{font-size:.76rem;color:var(--muted);line-height:1.55;border-top:1px solid var(--b1);padding-top:.4rem;margin-top:.3rem}

/* result actions */
.r-actions{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-top:1.5rem}
.r-actions .ra-full{grid-column:1/-1}
.ra-btn{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:.4rem;
  padding:.85rem;
  border-radius:var(--r2);
  font-family:var(--font);
  font-weight:800;
  font-size:.88rem;
  cursor:pointer;
  border:none;
  transition:all .2s;
  user-select:none;
}

.ra-primary{background:var(--grad);color:#fff;box-shadow:0 4px 18px rgba(91,106,240,.35)}
.ra-primary:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(91,106,240,.5)}
.ra-ghost{background:var(--card2);border:1.5px solid var(--b2);color:var(--text)}
.ra-ghost:hover{border-color:var(--acc2);color:var(--acc3)}

/* â”€â”€ STATS SCREEN â”€â”€ */
.stats-hero{text-align:center;margin-bottom:1.5rem}
.stats-overview{display:grid;grid-template-columns:repeat(3,1fr);gap:.75rem;margin-bottom:1.5rem}
.so-card{background:var(--card2);border:1px solid var(--b1);border-radius:var(--r2);padding:1.1rem;text-align:center}
.so-val{font-family:var(--mono);font-weight:700;font-size:1.7rem;line-height:1}
.so-lbl{font-size:.65rem;color:var(--sub);text-transform:uppercase;letter-spacing:.08em;margin-top:.2rem}
.leaderboard{display:flex;flex-direction:column;gap:.45rem;margin-bottom:1.3rem}
.lb-row{background:var(--card2);border:1px solid var(--b1);border-radius:var(--r2);padding:.7rem 1rem;display:flex;align-items:center;gap:.8rem}
.lb-rank{width:28px;font-family:var(--mono);font-weight:700;font-size:.85rem;color:var(--muted);text-align:center;flex-shrink:0}
.lb-rank.gold{color:#fbbf24}.lb-rank.silver{color:#94a3b8}.lb-rank.bronze{color:#b45309}
.lb-name{flex:1;font-weight:700;font-size:.85rem}
.lb-score{font-family:var(--mono);font-weight:700;font-size:.9rem;color:var(--acc3)}
.lb-badge{font-size:.62rem;padding:.15rem .5rem;background:rgba(91,106,240,.12);border:1px solid rgba(91,106,240,.25);border-radius:20px;color:var(--acc3);font-weight:700}
.perf-grid{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1.3rem}
.perf-card{background:var(--card2);border:1px solid var(--b1);border-radius:var(--r2);padding:1.1rem}
.pc-label{font-size:.68rem;font-weight:700;color:var(--sub);text-transform:uppercase;letter-spacing:.1em;margin-bottom:.5rem}
.pc-val{font-family:var(--mono);font-weight:700;font-size:1.3rem;margin-bottom:.4rem}
.pc-bar{height:6px;background:var(--b1);border-radius:6px;overflow:hidden}
.pc-fill{height:100%;border-radius:6px;transition:width 1s cubic-bezier(.4,0,.2,1)}

/* â”€â”€ NAV TABS â”€â”€ */
.nav-tabs{display:flex;gap:.35rem;background:var(--card);border:1px solid var(--b1);border-radius:var(--r2);padding:.3rem;margin-bottom:1.5rem}
.nav-tab{flex:1;padding:.6rem .5rem;border-radius:var(--r3);font-size:.75rem;font-weight:700;background:transparent;border:none;color:var(--sub);cursor:pointer;font-family:var(--font);transition:all .2s;text-align:center;white-space:nowrap}
.nav-tab.active{background:var(--acc);color:#fff;box-shadow:0 2px 10px rgba(91,106,240,.3)}
.nav-tab:hover:not(.active){color:var(--acc3)}

/* â”€â”€ CONFETTI â”€â”€ */
.cf-layer{position:fixed;inset:0;pointer-events:none;z-index:500;overflow:hidden}
.cf-p{position:absolute;width:8px;height:8px;border-radius:2px;animation:cfDrop linear forwards}
@keyframes cfDrop{from{transform:translateY(-20px) rotate(0)}to{transform:translateY(100vh) rotate(720deg);opacity:0}}

/* â”€â”€ RESPONSIVE â”€â”€ */
@media(max-width:620px){
  .panel{padding:1.4rem}
  .q-card{padding:1.2rem 1.1rem}
  .diff-cards{grid-template-columns:1fr}
  .setup-row{grid-template-columns:1fr}
  .stat-grid{grid-template-columns:repeat(2,1fr)}
  .r-actions{grid-template-columns:1fr}
  .r-actions .ra-full{grid-column:unset}
  .dash-grid{grid-template-columns:1fr}
  .stats-overview{grid-template-columns:1fr 1fr}
  .perf-grid{grid-template-columns:1fr}
}
</style>
</head>
<body>
<div class="mesh"><span></span><span></span><span></span></div>
<div class="cf-layer" id="cf-layer"></div>
<div class="streak-toast" id="streak-toast">ğŸ”¥ <span id="stk-msg">3Ã— Streak!</span></div>

<div class="app">
  <nav class="topbar wrap">
    <div class="logo-row">
      <div class="logo-mark">ğŸ“š</div>
      <div>
        <div class="logo-text"><em>ExamEdge</em> Pro</div>
        <div class="logo-sub">Competitive Exam Platform</div>
      </div>
    </div>
    <div class="hud" id="hud">
      <div class="hud-chip usr" id="hud-user">ğŸ‘¤ Guest</div>
      <div class="hud-chip pts" id="hud-pts">âš¡ 0 pts</div>
      <button class="hud-logout" id="btn-logout">Sign out</button>
    </div>
  </nav>

  <div class="wrap">
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         S1 â€” LOGIN
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="screen active" id="s-login">
      <div class="login-box">
        <div class="login-hero">
          <div class="hero-icon">ğŸ“</div>
          <div class="page-title" style="font-size:1.8rem">Welcome to <em>ExamEdge Pro</em></div>
          <p style="font-size:.85rem;color:var(--sub);margin-top:.4rem">India's most comprehensive exam prep platform</p>
        </div>
        <div class="panel">
          <div class="auth-tabs">
            <button class="auth-tab active" data-tab="login">Sign In</button>
            <button class="auth-tab" data-tab="register">Register</button>
          </div>
          <!-- SIGN IN -->
          <div class="form-section active" id="form-login">
            <div class="field">
              <label>Username or Email</label>
              <div class="input-wrap">
                <input type="text" id="li-user" placeholder="Enter username" autocomplete="username"/>
              </div>
              <div class="field-error" id="li-user-err">Please enter your username</div>
            </div>
            <div class="field">
              <label>Password</label>
              <div class="input-wrap">
                <input type="password" id="li-pass" placeholder="Enter password" autocomplete="current-password"/>
                <span class="input-icon" id="li-eye">ğŸ‘</span>
              </div>
              <div class="field-error" id="li-pass-err">Please enter your password</div>
            </div>
            <div class="field-error" id="li-main-err" style="display:none;font-size:.82rem;text-align:center">âŒ Invalid credentials. Try demo accounts below.</div>
            <button class="btn btn-primary btn-full" id="btn-login">Sign In â†’</button>
            <div class="divider">or use demo account</div>
            <div class="demo-row">
              <div class="demo-chip" data-u="student1" data-p="pass123">ğŸ‘¤ student1</div>
              <div class="demo-chip" data-u="testuser" data-p="quiz456">ğŸ‘¤ testuser</div>
              <div class="demo-chip" data-u="admin" data-p="admin123">ğŸ‘‘ admin</div>
            </div>
          </div>
          <!-- REGISTER -->
          <div class="form-section" id="form-register">
            <div class="field">
              <label>Full Name</label>
              <input type="text" id="rg-name" placeholder="Your full name"/>
              <div class="field-error" id="rg-name-err">Name must be at least 2 characters</div>
            </div>
            <div class="field">
              <label>Email Address</label>
              <input type="email" id="rg-email" placeholder="your@email.com" autocomplete="email"/>
              <div class="field-error" id="rg-email-err">Enter a valid email address</div>
            </div>
            <div class="field">
              <label>Username</label>
              <input type="text" id="rg-user" placeholder="Choose a username" autocomplete="username"/>
              <div class="field-error" id="rg-user-err">Username must be 3+ characters</div>
            </div>
            <div class="field">
              <label>Password</label>
              <div class="input-wrap">
                <input type="password" id="rg-pass" placeholder="Min 6 characters" autocomplete="new-password"/>
                <span class="input-icon" id="rg-eye">ğŸ‘</span>
              </div>
              <div class="field-error" id="rg-pass-err">Password must be at least 6 characters</div>
            </div>
            <div class="field-error" id="rg-main-err" style="display:none;font-size:.82rem;text-align:center"></div>
            <button class="btn btn-primary btn-full" id="btn-register">Create Account â†’</button>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         S2 â€” DASHBOARD
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="screen" id="s-dashboard">
      <div class="nav-tabs" id="main-tabs">
        <button class="nav-tab active" data-s="dash">ğŸ  Dashboard</button>
        <button class="nav-tab" data-s="setup">ğŸ“ New Quiz</button>
        <button class="nav-tab" data-s="stats">ğŸ“Š Statistics</button>
      </div>

      <!-- DASHBOARD TAB -->
      <div id="tab-dash">
        <div class="page-title" style="margin-bottom:.3rem">Hello, <em id="d-name">Learner</em>! ğŸ‘‹</div>
        <p class="page-sub" style="margin-bottom:1.2rem">Pick an exam, set your difficulty and start practising</p>
        <div class="dash-grid">
          <div class="dash-stat">
            <div class="ds-icon" style="background:rgba(16,217,126,.15)">âœ…</div>
            <div><div class="ds-val" id="ds-total">0</div><div class="ds-lbl">Quizzes Taken</div></div>
          </div>
          <div class="dash-stat">
            <div class="ds-icon" style="background:rgba(91,106,240,.15)">âš¡</div>
            <div><div class="ds-val" id="ds-pts">0</div><div class="ds-lbl">Total Points</div></div>
          </div>
          <div class="dash-stat">
            <div class="ds-icon" style="background:rgba(251,191,36,.15)">ğŸ¯</div>
            <div><div class="ds-val" id="ds-acc">â€”</div><div class="ds-lbl">Best Accuracy</div></div>
          </div>
          <div class="dash-stat">
            <div class="ds-icon" style="background:rgba(255,77,109,.15)">ğŸ”¥</div>
            <div><div class="ds-val" id="ds-streak">0</div><div class="ds-lbl">Best Streak</div></div>
          </div>
        </div>
        <div class="section-label">Recent Attempts</div>
        <div class="history-list" id="history-list">
          <div class="empty-state">ğŸ“­ No quizzes yet â€” take your first quiz!</div>
        </div>
        <button class="btn btn-primary" style="margin-top:1rem" id="btn-go-setup">ğŸš€ Start New Quiz</button>
      </div>

      <!-- SETUP TAB -->
      <div id="tab-setup" style="display:none">
        <div class="page-title">Configure <em>Your Quiz</em></div>
        <p class="page-sub">Select exam, difficulty, timer & question count</p>

        <div class="section-label">1 â€” Choose Exam Categories (multi-select)</div>
        <div class="exam-grid" id="exam-grid"></div>

        <div class="section-label">2 â€” Difficulty Level</div>
        <div class="diff-cards">
          <div class="diff-card easy" data-d="easy">
            <div class="dc-check">âœ“</div>
            <div class="dc-icon">ğŸŒ±</div>
            <div class="dc-label">Easy</div>
            <div class="dc-pts">Base 80 pts/Q</div>
          </div>
          <div class="diff-card mid" data-d="mid">
            <div class="dc-check">âœ“</div>
            <div class="dc-icon">âš¡</div>
            <div class="dc-label">Medium</div>
            <div class="dc-pts">Base 120 pts/Q</div>
          </div>
          <div class="diff-card hard" data-d="hard">
            <div class="dc-check">âœ“</div>
            <div class="dc-icon">ğŸ’€</div>
            <div class="dc-label">Hard</div>
            <div class="dc-pts">Base 200 pts/Q</div>
          </div>
        </div>

        <div class="section-label">3 â€” Number of Questions</div>
        <div class="qcount-row" id="qcount-row">
          <button class="qc-btn" data-n="5">5 Qs</button>
          <button class="qc-btn active" data-n="10">10 Qs</button>
          <button class="qc-btn" data-n="15">15 Qs</button>
          <button class="qc-btn" data-n="20">20 Qs</button>
          <button class="qc-btn" data-n="25">25 Qs</button>
          <button class="qc-btn" data-n="30">30 Qs</button>
        </div>

        <div class="section-label">4 â€” Timer per Question</div>
        <div class="timer-config">
          <div class="tc-header">â± Time per question</div>
          <div class="timer-presets" id="timer-presets">
            <button class="tp-btn" data-t="10">10s</button>
            <button class="tp-btn" data-t="15">15s</button>
            <button class="tp-btn active" data-t="20">20s</button>
            <button class="tp-btn" data-t="30">30s</button>
            <button class="tp-btn" data-t="45">45s</button>
            <button class="tp-btn" data-t="60">60s</button>
            <button class="tp-btn" data-t="0">â™¾ None</button>
          </div>
          <div class="custom-row">
            <label>Custom:</label>
            <input type="range" id="t-slider" min="5" max="120" value="20" step="5"/>
            <div class="tval" id="tval-box">20s</div>
          </div>
        </div>

        <div class="preview-box">
          <div class="section-label" style="margin-bottom:.5rem">Quiz Preview</div>
          <div class="prev-row">
            <span>ğŸ“š Exams: <strong id="pv-exams">None</strong></span>
            <span>ğŸ¯ Difficulty: <strong id="pv-diff">â€”</strong></span>
            <span>â“ Questions: <strong id="pv-count">10</strong></span>
            <span>â± Timer: <strong id="pv-timer">20s</strong></span>
          </div>
        </div>

        <div class="btn-row">
          <button class="btn btn-primary" id="btn-start-quiz" disabled>ğŸš€ Start Quiz</button>
          <button class="btn btn-outline" id="btn-reset-setup">Reset</button>
        </div>
      </div>

      <!-- STATS TAB -->
      <div id="tab-stats" style="display:none">
        <div class="stats-hero">
          <div class="page-title">Your <em>Statistics</em></div>
          <p style="font-size:.84rem;color:var(--sub)">Track your performance over time</p>
        </div>
        <div class="stats-overview">
          <div class="so-card"><div class="so-val" style="color:var(--green)" id="so-total">0</div><div class="so-lbl">Total Quizzes</div></div>
          <div class="so-card"><div class="so-val" style="color:var(--acc3)" id="so-pts">0</div><div class="so-lbl">Total Points</div></div>
          <div class="so-card"><div class="so-val" style="color:var(--amber)" id="so-avg">â€”</div><div class="so-lbl">Avg Accuracy</div></div>
        </div>
        <div class="section-label">Performance by Exam</div>
        <div id="perf-grid" class="perf-grid"></div>
        <div class="section-label">All-Time Leaderboard</div>
        <div class="leaderboard" id="leaderboard"></div>
        <div class="section-label">Recent History (All Attempts)</div>
        <div class="history-list" id="stats-history"></div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         S3 â€” QUIZ
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="screen" id="s-quiz">
      <div class="quiz-header">
        <div class="qh-left">
          <div class="qh-pill" id="qh-exam">ğŸ“š Exam</div>
          <div class="qh-pill" id="qh-diff">ğŸŒ± Easy</div>
        </div>
        <div class="qh-right">
          <div class="qstat s-pts">âš¡ <span id="qs-pts">0</span></div>
          <div class="qstat s-stk hidden" id="qs-stk-box">ğŸ”¥ <span id="qs-stk">0</span></div>
        </div>
      </div>
      <div class="timer-bar-wrap">
        <div class="tbar-top">
          <div class="tbar-track"><div class="tbar-fill" id="tbar-fill"></div></div>
          <div class="timer-box" id="timer-box">
            <div class="tn" id="t-num">â€”</div>
            <div class="tl">sec</div>
          </div>
        </div>
      </div>
      <div class="prog-wrap">
        <div class="prog-meta"><span class="frac" id="pq-frac">1/10</span><span id="pq-pct">0%</span></div>
        <div class="prog-track"><div class="prog-bar" id="prog-bar"></div></div>
        <div class="dot-nav" id="dot-nav"></div>
      </div>
      <div class="q-card">
        <div class="q-tags">
          <span class="qtag qtag-diff" id="qt-diff">ğŸŒ± Easy</span>
          <span class="qtag qtag-cat" id="qt-cat">ğŸ“š</span>
        </div>
        <div class="q-num" id="q-num-lbl">Question 1 of 10</div>
        <div class="q-text" id="q-text">Loadingâ€¦</div>
        <div class="multi-note" id="multi-note" style="display:none">âš ï¸ Multiple correct answers â€” select all that apply</div>
      </div>
      <div class="opts" id="opts"></div>
      <div class="feedback" id="feedback"></div>
      <div class="explain-box" id="explain-box">
        <div class="ex-title">ğŸ’¡ Explanation</div>
        <div id="explain-text"></div>
      </div>
      <div class="quiz-nav">
        <button class="btn btn-outline" id="btn-qback" disabled>â† Back</button>
        <button class="btn btn-ghost" id="btn-skip">Skip</button>
        <button class="btn btn-primary" id="btn-qnext" disabled>Next â†’</button>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         S4 â€” RESULTS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="screen" id="s-result">
      <div class="panel">
        <div class="result-hero">
          <div class="rh-emoji" id="rh-emoji">ğŸ‰</div>
          <div class="rh-title"><em id="rh-title">Well Done!</em></div>
          <div class="rh-sub" id="rh-sub">Here's how you performed</div>
          <div class="ring-wrap">
            <svg class="ring-svg" width="148" height="148" viewBox="0 0 148 148">
              <circle class="ring-bg" cx="74" cy="74" r="60"/>
              <circle class="ring-fg" id="ring-fg" cx="74" cy="74" r="60" stroke-dasharray="376.99" stroke-dashoffset="376.99"/>
            </svg>
            <div class="ring-center">
              <div class="ring-pct" id="ring-pct">0%</div>
              <div class="ring-lbl">accuracy</div>
            </div>
          </div>
        </div>
        <div class="acc-bar-wrap">
          <div class="acc-labels"><span>Overall Accuracy</span><strong id="acc-txt">0%</strong></div>
          <div class="acc-track"><div class="acc-fill" id="acc-fill" style="width:0"></div></div>
        </div>
        <div class="stat-grid">
          <div class="sbox sv-ok"><div class="sv" id="r-cor">0</div><div class="sl">Correct</div></div>
          <div class="sbox sv-bad"><div class="sv" id="r-wrg">0</div><div class="sl">Wrong</div></div>
          <div class="sbox sv-skip"><div class="sv" id="r-skp">0</div><div class="sl">Skipped</div></div>
          <div class="sbox sv-pts"><div class="sv" id="r-pts">0</div><div class="sl">Points</div></div>
        </div>
        <div class="section-label">Category Breakdown</div>
        <div class="bd-list" id="bd-list"></div>
        <div class="review-hdr" id="rv-hdr"><span class="rh-ttl">ğŸ“ Answer Review</span><span class="rh-ico">â–¼</span></div>
        <div class="review-items" id="rv-items"></div>
        <div class="r-actions">
          <button class="ra-btn ra-ghost" id="ra-retry">ğŸ” Retry</button>
          <button class="ra-btn ra-ghost" id="ra-newsetup">âš™ï¸ New Setup</button>
          <button class="ra-btn ra-primary ra-full" id="ra-dash">ğŸ  Back to Dashboard</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
'use strict';
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUESTION DATABASE  (8 exams Ã— 3 difficulties Ã— 6â€“8 Qs)
//  Each Q has: q, options[4], correct (array of indices),
//              explanation, multi (bool)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DB = {
  tnpsc:{
    name:'TNPSC', icon:'ğŸ›ï¸', badge:'eb-tnpsc', label:'TNPSC', desc:'Tamil Nadu Public Service',
    easy:[
      {q:'Who is known as the "Iron Man of India"?',o:['Jawaharlal Nehru','Sardar Vallabhbhai Patel','Subhas Chandra Bose','Bhim Rao Ambedkar'],c:[1],e:'Sardar Vallabhbhai Patel unified the princely states after Independence and is called the Iron Man of India.'},
      {q:'Tamil Nadu was formed on which date?',o:['1 November 1956','26 January 1950','15 August 1947','14 April 1960'],c:[0],e:'Tamil Nadu was formed on 1 November 1956 during the States Reorganisation Act based on linguistic lines.'},
      {q:'Which river is called the "Lifeline of Tamil Nadu"?',o:['Krishna','Cauvery','Godavari','Palar'],c:[1],e:'The Cauvery river is called the lifeline of Tamil Nadu as it irrigates the fertile delta region.'},
      {q:'The capital of Tamil Nadu is:',o:['Coimbatore','Madurai','Chennai','Trichy'],c:[2],e:'Chennai (formerly Madras) is the capital and largest city of Tamil Nadu.'},
      {q:'Which of these is the classical language of Tamil Nadu?',o:['Sanskrit','Hindi','Tamil','Kannada'],c:[2],e:'Tamil is one of the oldest classical languages in the world and the official language of Tamil Nadu.'},
      {q:'Who was the first Chief Minister of Tamil Nadu?',o:['M.G. Ramachandran','C.N. Annadurai','Kamaraj','Jayalalithaa'],c:[2],e:'Perunthalaivar Kamarajar (K. Kamaraj) was the Chief Minister of Tamil Nadu from 1954 to 1963.'},
    ],
    mid:[
      {q:'The Nilgiris Biosphere Reserve is located in which state primarily?',o:['Kerala','Karnataka','Tamil Nadu','Andhra Pradesh'],c:[2],e:'Nilgiris Biosphere Reserve mainly falls in Tamil Nadu, covering the Nilgiri hills area.'},
      {q:'Article 370 was related to:',o:['Language rights','Special status of J&K','Scheduled tribes','Reservation policy'],c:[1],e:'Article 370 granted special autonomous status to Jammu & Kashmir, abrogated in August 2019.'},
      {q:'Which TNPSC Group exam recruits for District Collector posts?',o:['Group I','Group II','Group IV','Group VIII'],c:[0],e:'TNPSC Group I services include IAS-level state posts like Deputy Collector, DSP, etc.'},
      {q:'The Panchayati Raj system in India is governed under which article?',o:['Article 40','Article 73','Article 243','Article 356'],c:[2],e:'Articles 243 to 243O (73rd Amendment, 1992) deal with Panchayati Raj institutions.'},
      {q:'Which Five Year Plan focused on "Growth with Social Justice"?',o:['5th','8th','10th','11th'],c:[3],e:'The 11th Five Year Plan (2007â€“2012) had the theme "Faster and More Inclusive Growth / Growth with Social Justice."'},
      {q:'The Vedantha Rishi Award in Tamil Nadu is given for excellence in:',o:['Agriculture','Literature','Sports','Science'],c:[1],e:'The Vedantha Rishi Award is presented for outstanding contribution to Tamil literature.'},
    ],
    hard:[
      {q:'Under which schedule of the Indian Constitution are the Panchayat powers listed?',o:['Ninth Schedule','Tenth Schedule','Eleventh Schedule','Twelfth Schedule'],c:[2],e:'The Eleventh Schedule (added by 73rd Amendment) lists 29 subjects under Panchayat jurisdiction.'},
      {q:'Which Article of Indian Constitution abolishes untouchability?',o:['Article 14','Article 15','Article 17','Article 21'],c:[2],e:'Article 17 abolishes untouchability and forbids its practice in any form.'},
      {q:'The Doctrine of Lapse was introduced by:',o:['Lord Dalhousie','Lord Cornwallis','Lord Wellesley','Lord Canning'],c:[0],e:'Governor-General Lord Dalhousie introduced the Doctrine of Lapse (1848), annexing states without a male heir.'},
      {q:'Megasthenes was the ambassador of which Greek ruler to Chandragupta Maurya?',o:['Alexander','Seleucus I Nicator','Ptolemy','Antigonus'],c:[1],e:'Megasthenes served as ambassador of Seleucus I Nicator to the Mauryan court of Chandragupta Maurya.'},
      {q:'The Rowlatt Act (1919) allowed:',o:['Voting rights to Indians','Detention without trial','Press freedom','Trade union rights'],c:[1],e:'The Rowlatt Act empowered the British to detain any person without trial, triggering the Non-Cooperation Movement.'},
      {q:'Which of the following is NOT a Fundamental Duty under Article 51A?',o:['Protect environment','Pay taxes','Safeguard public property','Develop scientific temper'],c:[1],e:'Paying taxes is not listed among the 11 Fundamental Duties under Article 51A of the Indian Constitution.'},
    ]
  },
  ssc:{
    name:'SSC', icon:'ğŸ“‹', badge:'eb-ssc', label:'SSC CGL/CHSL', desc:'Staff Selection Commission',
    easy:[
      {q:'Which is the smallest prime number?',o:['0','1','2','3'],c:[2],e:'2 is the smallest and the only even prime number.'},
      {q:'Who wrote "Discovery of India"?',o:['M.K. Gandhi','Jawaharlal Nehru','Rabindranath Tagore','B.R. Ambedkar'],c:[1],e:'"Discovery of India" was written by Jawaharlal Nehru while imprisoned at Ahmednagar Fort (1944).'},
      {q:'The synonym of "Eloquent" is:',o:['Fluent','Silent','Confused','Rough'],c:[0],e:'Eloquent means fluent or persuasive in speaking or writing.'},
      {q:'If CLOCK = 25341, then LOCK = ?',o:['5341','2534','3541','5314'],c:[0],e:'Removing C (2) from CLOCK gives LOCK = 5341.'},
      {q:'Speed of sound in air at 0Â°C is approximately:',o:['232 m/s','331 m/s','440 m/s','550 m/s'],c:[1],e:'Speed of sound in dry air at 0Â°C is approximately 331 m/s, increasing with temperature.'},
      {q:'A train 200m long passes a pole in 10 seconds. Its speed is:',o:['10 m/s','15 m/s','20 m/s','25 m/s'],c:[2],e:'Speed = Distance/Time = 200/10 = 20 m/s.'},
    ],
    mid:[
      {q:'If 3x + 5 = 20, find x.',o:['3','5','4','6'],c:[1],e:'3x = 20-5 = 15, so x = 5.'},
      {q:'The antonym of "Obdurate" is:',o:['Stubborn','Yielding','Harsh','Indifferent'],c:[1],e:'Obdurate means stubbornly refusing to change; its antonym is yielding or flexible.'},
      {q:'Average of 5 numbers is 20. If one number is removed, average becomes 18. The removed number is:',o:['24','28','20','32'],c:[1],e:'Sum of 5 = 100. Sum of 4 = 72. Removed number = 100-72 = 28.'},
      {q:'Select the correctly spelt word:',o:['Accomodate','Accommodate','Acomodate','Accomdate'],c:[1],e:'"Accommodate" is spelled with double c and double m â€” a common misspelling trap.'},
      {q:'A can do a work in 10 days, B in 15 days. Together in:',o:['5 days','6 days','7 days','8 days'],c:[1],e:'Combined rate = 1/10 + 1/15 = 3/30 + 2/30 = 5/30 = 1/6. So together = 6 days.'},
      {q:'Which article deals with Right to Constitutional Remedies?',o:['Article 19','Article 25','Article 32','Article 44'],c:[2],e:'Article 32 provides the right to move the Supreme Court for enforcement of fundamental rights â€” the "heart of the Constitution" per Ambedkar.'},
    ],
    hard:[
      {q:'If (a+b)=10 and ab=21, find aÂ²+bÂ².',o:['52','58','62','100'],c:[1],e:'aÂ²+bÂ² = (a+b)Â² - 2ab = 100 - 42 = 58.'},
      {q:'Which of these is a correct passive voice: "She teaches English"?',o:['English is taught by her','English was taught by her','English has taught by her','English being taught by her'],c:[0],e:'Simple Present Active â†’ Simple Present Passive: "English is taught by her."'},
      {q:'A compound interest on â‚¹8000 at 10% for 2 years = ?',o:['â‚¹1600','â‚¹1680','â‚¹1700','â‚¹1720'],c:[1],e:'CI = 8000[(1.1)Â²âˆ’1] = 8000 Ã— 0.21 = â‚¹1680.'},
      {q:'Identify the figure of speech: "The pen is mightier than the sword."',o:['Simile','Metaphor','Personification','Hyperbole'],c:[1],e:'This is a Metaphor â€” comparing pen (written word) to sword (military force) without using "like" or "as."'},
      {q:'LCM of 12, 18, 24 is:',o:['48','72','96','36'],c:[1],e:'LCM(12,18,24): 12=2Â²Ã—3, 18=2Ã—3Â², 24=2Â³Ã—3. LCM=2Â³Ã—3Â²=72.'},
      {q:'The Sun always rises in the East â€” this type of sentence is:',o:['Simple Present','Universal Truth','Habitual Action','Future fact'],c:[1],e:'Statements about universal truths use Simple Present tense, and this sentence is categorised as a Universal Truth.'},
    ]
  },
  rrb:{
    name:'RRB', icon:'ğŸš‚', badge:'eb-rrb', label:'RRB NTPC/JE', desc:'Railway Recruitment Board',
    easy:[
      {q:'Indian Railways was nationalised in:',o:['1947','1950','1951','1953'],c:[3],e:'Indian Railways was fully nationalised on 1 April 1953 when all private railway companies were merged.'},
      {q:'Which is the fastest train in India currently?',o:['Rajdhani Express','Shatabdi Express','Vande Bharat Express','Gatimaan Express'],c:[2],e:'Vande Bharat Express (Train 18) is India\'s fastest train, running at up to 160 km/h.'},
      {q:'A 300m train passes a 200m bridge in 25 sec. Speed of train:',o:['15 m/s','20 m/s','25 m/s','30 m/s'],c:[1],e:'Distance = 300+200 = 500m. Speed = 500/25 = 20 m/s.'},
      {q:'What is the full form of IRCTC?',o:['Indian Railway Catering and Tourism Corporation','Indian Railway Central Travel Company','Indian Railway Commerce and Tourism Corporation','Indian Revenue Catering Tourism Corp'],c:[0],e:'IRCTC stands for Indian Railway Catering and Tourism Corporation, handling ticketing and catering.'},
      {q:'The gauge of Konkan Railway is:',o:['Broad Gauge','Metre Gauge','Narrow Gauge','Standard Gauge'],c:[0],e:'Konkan Railway (760 km) uses Broad Gauge (1676 mm), which is the standard in India.'},
      {q:'Ohm\'s law states: V = ?',o:['IR','I/R','I+R','IÂ²R'],c:[0],e:'Ohm\'s Law: Voltage (V) = Current (I) Ã— Resistance (R). V=IR.'},
    ],
    mid:[
      {q:'SI unit of electrical resistance is:',o:['Ampere','Volt','Ohm','Watt'],c:[2],e:'The SI unit of electrical resistance is the Ohm (Î©), named after Georg Simon Ohm.'},
      {q:'If profit % = 25% and SP = â‚¹500, find CP.',o:['â‚¹375','â‚¹400','â‚¹425','â‚¹450'],c:[1],e:'CP = SP Ã— 100/(100+profit%) = 500Ã—100/125 = â‚¹400.'},
      {q:'Fleming\'s Left-Hand Rule is used for:',o:['Generators','Electric motors','Transformers','Inductors'],c:[1],e:"Fleming's Left-Hand Rule (FBI rule) determines the direction of force on a current-carrying conductor in a magnetic field â€” used for electric motors."},
      {q:'Which railway zone has HQ at Chennai?',o:['Southern Railway','South Central Railway','South Western Railway','South East Central Railway'],c:[0],e:'Southern Railway (SR) has its headquarters at Chennai, one of the oldest zones of Indian Railways.'},
      {q:'Transformer works on principle of:',o:['Electrostatics','Mutual induction','Self induction','Photoelectric effect'],c:[1],e:'A transformer works on the principle of mutual electromagnetic induction between two coils.'},
      {q:'A mixture of 80L has milk:water = 3:1. Water to be added to make 3:2 ratio:',o:['15L','20L','25L','30L'],c:[1],e:'Milk=60L, Water=20L. For 3:2, water needed=40L. Add 40-20=20L.'},
    ],
    hard:[
      {q:'Efficiency of a steam engine depends mainly on:',o:['Fuel type only','Temperature difference between source and sink','Pressure of steam only','Volume of cylinder'],c:[1],e:'Carnot efficiency = 1 - T_cold/T_hot. Maximum efficiency depends on the temperature difference between source and sink.'},
      {q:'A 600W motor lifts 30kg mass 10m in 5 sec. Its efficiency is:',o:['80%','90%','98%','100%'],c:[3],e:'Work done=mgh=30Ã—10Ã—10=3000J. Power input=600WÃ—5s=3000J. Efficiency=3000/3000=100%.'},
      {q:'RRB NTPC 2024 CBT-1 had how many questions?',o:['80','90','100','120'],c:[3],e:'RRB NTPC CBT-1 has 100 questions: 40 General Awareness + 30 Mathematics + 30 General Intelligence.'},
      {q:'Kirchhoff\'s Voltage Law (KVL) states:',o:['Sum of currents at node = 0','Sum of EMFs = sum of drops in a loop','Power in = Power out','Current divides inversely to resistance'],c:[1],e:'KVL: In any closed loop, the algebraic sum of all EMFs equals the algebraic sum of all voltage drops.'},
      {q:'Which type of signal does a digital circuit process?',o:['Continuous analogue','Discrete binary (0&1)','Sinusoidal','Random noise'],c:[1],e:'Digital circuits process discrete binary signals (0 and 1), unlike analogue circuits which handle continuous signals.'},
      {q:'If sin Î¸ = 3/5, find cos Î¸ (first quadrant):',o:['4/5','3/4','5/4','5/3'],c:[0],e:'cosÂ²Î¸ = 1-sinÂ²Î¸ = 1-9/25 = 16/25. cos Î¸ = 4/5.'},
    ]
  },
  banking:{
    name:'Banking', icon:'ğŸ¦', badge:'eb-bank', label:'IBPS/SBI/RBI', desc:'Bank PO & Clerk Exams',
    easy:[
      {q:'RBI stands for:',o:['Reserve Bank of India','Regulated Bank of India','Revenue Bank of India','Rural Bank of India'],c:[0],e:'RBI (Reserve Bank of India) is India\'s central bank, established on 1 April 1935.'},
      {q:'NEFT stands for:',o:['National Electronic Funds Transfer','National Electronic Fund Transaction','Net Electronic Funds Transfer','National Emergency Fund Transfer'],c:[0],e:'NEFT (National Electronic Funds Transfer) is an RBI-operated system for bank-to-bank money transfers.'},
      {q:'Repo rate is the rate at which:',o:['Banks lend to public','RBI lends to commercial banks','Government borrows from RBI','Banks lend to each other'],c:[1],e:'Repo (Repurchase) Rate is the interest rate at which the RBI lends short-term money to commercial banks.'},
      {q:'KYC stands for:',o:['Know Your Customer','Key Your Customer','Keep Your Credentials','Know Your Credit'],c:[0],e:'KYC (Know Your Customer) is a mandatory process banks use to verify the identity of their clients.'},
      {q:'What is the full form of ATM?',o:['Automated Teller Machine','Automatic Transfer Machine','Authorised Teller Machine','Automated Transaction Machine'],c:[0],e:'ATM stands for Automated Teller Machine, which allows customers to perform transactions without a bank teller.'},
      {q:'A sum doubles in 8 years at simple interest. Rate of interest:',o:['10%','12.5%','15%','8%'],c:[1],e:'For SI: Time = 100/(Rate). 8 = 100/R â†’ R = 12.5%.'},
    ],
    mid:[
      {q:'Basel III norms are related to:',o:['Agricultural lending','Capital adequacy of banks','FDI limits','Interest rate policy'],c:[1],e:'Basel III is a global regulatory framework on bank capital adequacy, stress testing, and liquidity requirements.'},
      {q:'CRR stands for:',o:['Cash Reserve Ratio','Credit Reserve Rate','Central Reserve Ratio','Currency Reserve Requirement'],c:[0],e:'CRR (Cash Reserve Ratio) is the percentage of deposits banks must hold in reserve with the RBI.'},
      {q:'SARFAESI Act is related to:',o:['Corporate tax','NPA recovery by banks','Insurance regulation','Securities market'],c:[1],e:'SARFAESI Act 2002 enables banks to recover NPAs by enforcing security interest without court intervention.'},
      {q:'Which bank is NOT a nationalised bank?',o:['Punjab National Bank','HDFC Bank','Bank of Baroda','Canara Bank'],c:[1],e:'HDFC Bank is a private sector bank. The others â€” PNB, BoB, Canara â€” are nationalised (public sector) banks.'},
      {q:'Compound Interest on â‚¹10000 at 10% for 3 years:',o:['â‚¹3000','â‚¹3100','â‚¹3310','â‚¹3200'],c:[2],e:'CI = 10000[(1.1)Â³-1] = 10000[1.331-1] = 10000Ã—0.331 = â‚¹3310.'},
      {q:'Priority Sector Lending target for domestic banks is:',o:['30%','35%','40%','45%'],c:[2],e:'RBI mandates domestic commercial banks to lend at least 40% of Adjusted Net Bank Credit (ANBC) to priority sectors.'},
    ],
    hard:[
      {q:'Under PMJDY, zero-balance account holders get overdraft of:',o:['â‚¹5000','â‚¹10000','â‚¹15000','â‚¹2000'],c:[1],e:'Under PMJDY (PM Jan Dhan Yojana), eligible account holders get an overdraft facility up to â‚¹10,000.'},
      {q:'The concept of "Narrow Banking" means banks invest deposits in:',o:['Risky corporate bonds','Only government securities','Real estate','Equity shares'],c:[1],e:'Narrow banking restricts banks to invest only in government/low-risk securities, eliminating credit risk.'},
      {q:'Which of the following is CORRECT about Reverse Repo Rate?',o:['RBI borrows from banks at this rate','Banks borrow from RBI at this rate','Rate for inter-bank lending','Rate for foreign currency loans'],c:[0],e:'Reverse Repo Rate is the rate at which the RBI borrows funds from commercial banks â€” absorbing liquidity from the system.'},
      {q:'CRAR (Capital to Risk Assets Ratio) under Basel III for Indian banks must be:',o:['8%','9%','10%','11.5%'],c:[3],e:'As per RBI guidelines aligned with Basel III, Indian banks must maintain a minimum CRAR of 11.5% (including capital conservation buffer).'},
      {q:'Which Committee recommended setting up of NABARD?',o:['Narasimham Committee','Shivaraman Committee','Nayak Committee','Kelkar Committee'],c:[1],e:'The B. Sivaraman Committee (1979) recommended the establishment of NABARD for agricultural and rural development finance.'},
      {q:'Open Market Operations (OMO) by RBI involves:',o:['Buying/selling foreign currency','Buying/selling government securities','Setting interest rates','Regulating NBFCs'],c:[1],e:'OMO refers to RBI buying or selling government securities in the open market to control money supply and liquidity.'},
    ]
  },
  upsc:{
    name:'UPSC', icon:'ğŸ…', badge:'eb-upsc', label:'UPSC CSE/IAS', desc:'Civil Services Examination',
    easy:[
      {q:'The Preamble of the Indian Constitution begins with:',o:['"We the People of India"','The sovereign state of India','India that is Bharat','The Constitution of India'],c:[0],e:'The Preamble begins with "WE, THE PEOPLE OF INDIA" asserting the democratic and republican nature of the Constitution.'},
      {q:'When was the Indian Constitution adopted?',o:['15 August 1947','26 January 1950','26 November 1949','2 October 1949'],c:[2],e:'The Constitution of India was adopted on 26 November 1949 (Constitution Day) and came into force on 26 January 1950.'},
      {q:'India is a:',o:['Federal state','Unitary state','Quasi-federal state','Confederation'],c:[2],e:'India is described as a "Union of States" with a quasi-federal structure â€” stronger centre but federal features.'},
      {q:'The concept of Judicial Review in India is borrowed from:',o:['UK','USA','Canada','Australia'],c:[1],e:'Judicial Review â€” the power to declare laws unconstitutional â€” is borrowed from the USA.'},
      {q:'Which Article grants citizenship rights at the commencement of the Constitution?',o:['Article 5','Article 11','Article 13','Article 19'],c:[0],e:'Articles 5 to 11 deal with citizenship. Article 5 specifies citizenship at commencement (26 Jan 1950).'},
      {q:'Who chairs the NITI Aayog?',o:['Finance Minister','RBI Governor','Prime Minister','Home Minister'],c:[2],e:'The Prime Minister of India is the ex-officio Chairman of NITI Aayog (replaced Planning Commission in 2015).'},
    ],
    mid:[
      {q:'Which of the following is a feature of Parliamentary Government in India?',o:['Fixed tenure of PM','Separation of powers','Collective responsibility of Cabinet','Dual executive with equal powers'],c:[2],e:'In India\'s parliamentary system, the Council of Ministers is collectively responsible to the Lok Sabha.'},
      {q:'The Directive Principles of State Policy are in which part of the Constitution?',o:['Part III','Part IV','Part IVA','Part V'],c:[1],e:'Part IV (Articles 36-51) contains Directive Principles of State Policy â€” non-justiciable but fundamental to governance.'},
      {q:'La NiÃ±a leads to:',o:['Warmer Pacific','Cooler Pacific and stronger monsoon in India','Droughts in India','Warmer Indian Ocean'],c:[1],e:'La NiÃ±a = cooling of central/eastern Pacific. It typically strengthens the Indian summer monsoon, increasing rainfall.'},
      {q:'Which gas is responsible for the "Greenhouse Effect" primarily?',o:['Oxygen','Nitrogen','Carbon Dioxide','Argon'],c:[2],e:'COâ‚‚ is the dominant greenhouse gas contributing to global warming, though methane and water vapour also contribute.'},
      {q:'Biodiversity Hot Spots are areas with:',o:['High species richness and high threat','Low species richness','Only endemic species','National parks only'],c:[0],e:'A biodiversity hotspot must have â‰¥1500 endemic vascular plants AND have lost â‰¥70% of its original habitat.'},
      {q:'The term "Secular" was added to the Preamble by:',o:['Original Constitution','42nd Amendment','44th Amendment','73rd Amendment'],c:[1],e:'The words "Socialist" and "Secular" were added to the Preamble by the 42nd Constitutional Amendment (1976) during the Emergency.'},
    ],
    hard:[
      {q:'Which Schedule of the Indian Constitution deals with anti-defection?',o:['Eighth','Ninth','Tenth','Eleventh'],c:[2],e:'The Tenth Schedule (added by 52nd Amendment, 1985) contains provisions for disqualification on grounds of defection.'},
      {q:'Precautionary Principle in environmental law means:',o:['Polluter pays for damage','Preventive action when evidence is uncertain','Environmental impact assessment','Biodiversity compensation'],c:[1],e:'The Precautionary Principle states that lack of full scientific certainty should not be used as reason to postpone preventive action against environmental threats.'},
      {q:'The concept of "Basic Structure" of the Constitution was given in:',o:['A.K. Gopalan case','Golak Nath case','Kesavananda Bharati case','Minerva Mills case'],c:[2],e:'Kesavananda Bharati v. State of Kerala (1973) â€” 13-judge bench â€” established the Basic Structure Doctrine limiting Parliament\'s amendment power.'},
      {q:'Which Finance Commission recommended GST Council?',o:['12th','13th','14th','15th'],c:[1],e:'The 13th Finance Commission (2010) recommended the creation of a GST Council, which was later established under Article 279A.'},
      {q:'UNFCCC Conference of Parties (COP) is held:',o:['Every 5 years','Every year','Twice a year','Every 2 years'],c:[1],e:'UNFCCC COP (Conference of Parties) is held annually, e.g., COP21 (Paris 2015), COP26 (Glasgow 2021), COP28 (Dubai 2023).'},
      {q:'"Hardship Clause" in international contracts refers to:',o:['Penalty for breach','Exemption due to unforeseen events changing balance','Extension of deadline','Dispute arbitration'],c:[1],e:'A Hardship Clause allows renegotiation of contract terms when unforeseen events fundamentally alter the equilibrium of the contract (related to force majeure).'},
    ]
  },
  ese:{
    name:'ESE', icon:'âš™ï¸', badge:'eb-ese', label:'Eng. Services', desc:'Engineering Services Exam',
    easy:[
      {q:'Ohm\'s law applies to which type of conductors?',o:['Non-linear','Linear','Semiconductor','Superconductors'],c:[1],e:'Ohm\'s Law (V=IR) applies to ohmic/linear conductors where resistance is constant with temperature.'},
      {q:'The unit of power is:',o:['Joule','Newton','Watt','Pascal'],c:[2],e:'Watt (W) is the SI unit of power = energy per unit time = J/s.'},
      {q:'Which material has the highest thermal conductivity?',o:['Iron','Copper','Diamond','Aluminium'],c:[2],e:'Diamond has the highest thermal conductivity (~2000 W/mÂ·K) among natural materials, higher than copper (~400 W/mÂ·K).'},
      {q:'Pascal is the unit of:',o:['Force','Pressure','Energy','Power'],c:[1],e:'Pascal (Pa) is the SI unit of pressure = Force/Area = N/mÂ².'},
      {q:'The efficiency of a Carnot engine operating between 500K and 300K is:',o:['30%','40%','50%','60%'],c:[1],e:'Carnot efficiency = 1 - T_cold/T_hot = 1 - 300/500 = 1 - 0.6 = 0.4 = 40%.'},
      {q:'Which logic gate gives output 1 only when both inputs are 1?',o:['OR','AND','NOT','NAND'],c:[1],e:'AND gate: output is HIGH (1) only when all inputs are HIGH (1). Truth: 0+0=0, 0+1=0, 1+0=0, 1+1=1.'},
    ],
    mid:[
      {q:'Bernoulli\'s equation is based on conservation of:',o:['Mass','Momentum','Energy','Charge'],c:[2],e:'Bernoulli\'s equation is derived from conservation of energy in fluid flow: P + Â½ÏvÂ² + Ïgh = constant.'},
      {q:'The resonant frequency of an LC circuit = ?',o:['1/(2Ï€âˆšLC)','2Ï€âˆšLC','1/(LC)','âˆš(L/C)'],c:[0],e:'Resonant frequency f = 1/(2Ï€âˆšLC), where L is inductance (Henry) and C is capacitance (Farad).'},
      {q:'A simply supported beam of span L carries UDL of w. Maximum bending moment is:',o:['wLÂ²/4','wLÂ²/8','wLÂ²/12','wL/2'],c:[1],e:'For a simply supported beam with UDL, maximum BM occurs at midspan = wLÂ²/8.'},
      {q:'The Laplace transform of e^(at) is:',o:['1/(s+a)','1/(s-a)','s/(s-a)','a/(s-a)'],c:[1],e:'L{e^(at)} = 1/(s-a), valid for s > a. This is a fundamental Laplace pair.'},
      {q:'Stress = Force/Area. If area doubles and force constant, stress:',o:['Doubles','Halves','Stays same','Quadruples'],c:[1],e:'Stress is inversely proportional to area. Double area â†’ half the stress.'},
      {q:'Which protocol works at the Transport layer of OSI model?',o:['HTTP','IP','TCP','Ethernet'],c:[2],e:'TCP (Transmission Control Protocol) and UDP operate at Layer 4 (Transport) of the OSI model.'},
    ],
    hard:[
      {q:'Which of the following is NOT a thermodynamic property?',o:['Enthalpy','Entropy','Heat','Internal Energy'],c:[2],e:'Heat (Q) and Work (W) are path functions (not properties). Enthalpy (H), Entropy (S), and Internal Energy (U) are state properties.'},
      {q:"Mohr's circle is used to find:",o:['Principal stresses','Flow velocities','Bending moments','Natural frequencies'],c:[0],e:"Mohr's Circle graphically represents the stress transformation equations and is used to find principal stresses, max shear stress, and stress on any plane."},
      {q:'The Z-transform of u[n] (unit step) is:',o:['1/(z-1)','z/(z-1)','1/z','z'],c:[1],e:'Z{u[n]} = z/(z-1) for |z|>1. This is derived from the geometric series sum.'},
      {q:'Rankine cycle is used for:',o:['Gas turbines','Refrigeration','Steam power plants','Internal combustion engines'],c:[2],e:'The Rankine cycle is the ideal thermodynamic cycle for steam power plants (working fluid: water/steam).'},
      {q:'A feedback control system is stable if all poles are:',o:['On imaginary axis','In right half s-plane','In left half s-plane','At origin'],c:[2],e:'For BIBO (Bounded Input Bounded Output) stability, all poles of the transfer function must lie in the Left Half of the s-plane (negative real parts).'},
      {q:'Euler\'s buckling load P_cr for a column with both ends pinned:',o:['Ï€Â²EI/LÂ²','4Ï€Â²EI/LÂ²','Ï€Â²EI/4LÂ²','2Ï€Â²EI/LÂ²'],c:[0],e:"Euler's critical load: P_cr = Ï€Â²EI/LÂ² for a pin-pin (both ends hinged) column of length L, flexural rigidity EI."},
    ]
  },
  gate:{
    name:'GATE', icon:'ğŸ”¬', badge:'eb-gate', label:'GATE', desc:'Graduate Aptitude Test Engg.',
    easy:[
      {q:'Time complexity of linear search in worst case:',o:['O(1)','O(log n)','O(n)','O(nÂ²)'],c:[2],e:'Linear search scans each element sequentially. Worst case = element at last position or absent â†’ O(n).'},
      {q:'Which data structure uses LIFO?',o:['Queue','Stack','Linked List','Tree'],c:[1],e:'Stack uses LIFO (Last In First Out). Push adds to top, Pop removes from top.'},
      {q:'Deterministic Finite Automaton (DFA) accepts:',o:['Type-0 language','Type-1 language','Type-2 language','Type-3 language (Regular)'],c:[3],e:'DFAs accept Regular Languages (Type-3 in Chomsky hierarchy). They cannot accept context-free or context-sensitive languages.'},
      {q:'For a binary tree with n nodes, the number of NULL pointers is:',o:['n-1','n','n+1','2n'],c:[2],e:'A binary tree with n nodes has n+1 NULL (leaf) pointers. Total links = 2n, internal = n-1, NULL = 2n-(n-1) = n+1.'},
      {q:'In a full binary tree with n internal nodes, leaves = ?',o:['n','n-1','n+1','2n'],c:[2],e:'Full binary tree: number of leaves = number of internal nodes + 1 = n+1.'},
      {q:'SQL SELECT query filters rows with:',o:['GROUP BY','ORDER BY','WHERE','HAVING'],c:[2],e:'WHERE clause filters rows before grouping. HAVING filters after GROUP BY. ORDER BY sorts. GROUP BY aggregates.'},
    ],
    mid:[
      {q:'Which sorting algorithm has best worst-case time complexity?',o:['Quick Sort','Bubble Sort','Merge Sort','Insertion Sort'],c:[2],e:'Merge Sort guarantees O(n log n) in all cases (best, average, worst), unlike QuickSort which can be O(nÂ²) worst case.'},
      {q:'Deadlock necessary conditions include: Mutual Exclusion, Hold and Wait, No Preemption, and:',o:['Priority Inversion','Circular Wait','Starvation','Context Switch'],c:[1],e:"Coffman's four necessary conditions for deadlock: Mutual Exclusion, Hold and Wait, No Preemption, and Circular Wait."},
      {q:'In a relational DB, a super key that has no proper subset being a key is called:',o:['Primary Key','Super Key','Candidate Key','Foreign Key'],c:[2],e:'A Candidate Key is a minimal super key â€” no proper subset of it can uniquely identify tuples.'},
      {q:'Virtual memory uses the concept of:',o:['Cache mapping','Demand paging','RAID storage','DMA transfer'],c:[1],e:'Virtual memory uses demand paging â€” pages are loaded into RAM only when needed, not all at once.'},
      {q:'The Context Free Language L = {aâ¿bâ¿ | nâ‰¥1} is accepted by:',o:['DFA','NFA','Push-Down Automaton','Turing Machine'],c:[2],e:'CFL {aâ¿bâ¿} requires a stack for matching n a\'s with n b\'s â†’ accepted by Push-Down Automata (PDA).'},
      {q:'Eigenvalues of a matrix [[2,1],[1,2]] are:',o:['1,3','2,2','0,4','1,2'],c:[0],e:'Î»Â² - 4Î» + 3 = 0 â†’ (Î»-1)(Î»-3) = 0 â†’ eigenvalues = 1 and 3.'},
    ],
    hard:[
      {q:'In CPU scheduling, which algorithm may cause starvation?',o:['FCFS','Round Robin','Priority Scheduling','SRTF'],c:[2,3],multi:true,e:'Priority Scheduling and SRTF (Shortest Remaining Time First) can both cause starvation. Low-priority/long processes may never execute if high-priority/short processes keep arriving.'},
      {q:'NP-Complete problems are NP problems that:',o:['Can be solved in polynomial time','Every NP problem reduces to them in poly time','Are decidable','Have no solution'],c:[1],e:'NP-Complete: A problem in NP to which every NP problem can be reduced in polynomial time. If any NPC is solvable in poly time, P=NP.'},
      {q:'The Master Theorem T(n) = 2T(n/2) + n gives complexity:',o:['O(n)','O(n log n)','O(nÂ²)','O(log n)'],c:[1],e:"By Master Theorem Case 2: a=2, b=2, f(n)=n, log_b(a)=1 = O(nÂ¹). Since f(n)=Î˜(n^log_b(a)) â†’ T(n)=O(n log n)."},
      {q:'Bellman-Ford algorithm detects:',o:['Only shortest path','Negative weight cycles','Minimum spanning tree','Maximum flow'],c:[1],e:'Bellman-Ford detects negative weight cycles (if after V-1 relaxations, further relaxation is possible) and finds shortest paths with negative edges.'},
      {q:'In a 2-3-4 tree, what is the equivalent balanced BST structure?',o:['AVL Tree','Splay Tree','Red-Black Tree','B+ Tree'],c:[2],e:'A 2-3-4 tree is isomorphic to a Red-Black Tree. The correspondence: 4-node=black node with two red children, 3-node=black node with one red child.'},
      {q:'Semaphore P(S) operation does:',o:['S=S+1; signal','S=S-1; if S<0 block process','S=S+1; unblock','S=0; reset'],c:[1],e:'P(S) (Wait/Down): S=S-1. If S<0, the process is blocked (added to wait queue). V(S) does S=S+1 and unblocks.'},
    ]
  },
  ugcnet:{
    name:'UGC NET', icon:'ğŸ“', badge:'eb-ugc', label:'UGC NET', desc:'National Eligibility Test',
    easy:[
      {q:'UGC NET is conducted for eligibility as:',o:['Bank Manager','Assistant Professor/JRF','IAS Officer','School Teacher'],c:[1],e:'UGC NET (National Eligibility Test) qualifies candidates for Assistant Professor and Junior Research Fellowship (JRF) positions.'},
      {q:'The first computer language considered high-level is:',o:['Assembly','FORTRAN','COBOL','C'],c:[1],e:'FORTRAN (1957) is considered the first widely used high-level programming language, designed for scientific computation.'},
      {q:'Who propounded the Theory of Multiple Intelligences?',o:['Piaget','Vygotsky','Gardner','Bloom'],c:[2],e:"Howard Gardner proposed the Theory of Multiple Intelligences (1983) in 'Frames of Mind', identifying 8+ types including linguistic, logical, musical."},
      {q:'Which journal publishes peer-reviewed research in Computer Science by ACM?',o:['Nature','IEEE Trans.','Communications of the ACM','Science'],c:[2],e:'Communications of the ACM (CACM) is the flagship peer-reviewed journal of the Association for Computing Machinery.'},
      {q:'The term "Pedagogy" refers to:',o:['Art of learning','Art and science of teaching','Curriculum design','Student assessment'],c:[1],e:'Pedagogy is the art, science, and practice of teaching, especially the theory and methods of education.'},
      {q:'Research hypothesis is:',o:['Final conclusion','Tentative assumption tested in research','Literature review','Data analysis result'],c:[1],e:'A research hypothesis is a tentative, testable statement about the expected relationship between variables.'},
    ],
    mid:[
      {q:'Which sampling technique ensures every member has equal probability of selection?',o:['Cluster sampling','Stratified sampling','Simple Random Sampling','Purposive sampling'],c:[2],e:'Simple Random Sampling (SRS) gives every member of the population an equal and independent chance of being selected.'},
      {q:'The "p-value" in statistical testing represents:',o:['Confidence level','Probability of results given null hypothesis is true','Effect size','Sample variance'],c:[1],e:'The p-value is the probability of obtaining results as extreme as observed, assuming the null hypothesis is true. p < 0.05 typically rejects Hâ‚€.'},
      {q:'Constructivism in education was primarily propounded by:',o:['B.F. Skinner','John Dewey','Jean Piaget','Ivan Pavlov'],c:[2],e:'Jean Piaget\'s cognitive constructivism holds that learners actively construct knowledge through experience. Vygotsky added social dimensions.'},
      {q:'TCP/IP model operates at how many layers?',o:['4','5','6','7'],c:[0],e:'The TCP/IP model has 4 layers: Application, Transport, Internet, and Network Access (Link). The OSI model has 7.'},
      {q:'DOI stands for in academic publishing:',o:['Department of Information','Digital Object Identifier','Data Output Index','Document Origin ID'],c:[1],e:'DOI (Digital Object Identifier) is a persistent alphanumeric string assigned to a document, providing a permanent internet link.'},
      {q:'Bloom\'s Taxonomy highest cognitive level is:',o:['Analysis','Evaluation','Synthesis','Create (Creating)'],c:[3],e:'Revised Bloom\'s Taxonomy (2001): Remember, Understand, Apply, Analyse, Evaluate, Create. "Create" is the highest level.'},
    ],
    hard:[
      {q:'Type I error in hypothesis testing is:',o:['Accepting false null hypothesis','Rejecting true null hypothesis','Incorrect sample size','Wrong test statistic'],c:[1],e:'Type I Error (Î± error): Rejecting the null hypothesis when it is actually true (false positive). Type II (Î² error): Accepting false null.'},
      {q:'The Von Neumann architecture bottleneck is caused by:',o:['Multiple CPUs','Single shared bus for data and instructions','Cache miss','Parallel processing'],c:[1],e:'Von Neumann bottleneck: CPU and memory share a single bus for both data and instructions, limiting throughput. Solution: cache, pipelining.'},
      {q:'Action Research is best described as:',o:['Pure theoretical research','Practitioner-led inquiry to improve practice','Secondary data analysis','Randomised control trial'],c:[1],e:'Action Research is a cyclical process of inquiry by practitioners (teachers, managers) to identify problems, implement changes, and evaluate outcomes in real settings.'},
      {q:'Factor Analysis reduces many variables to fewer:',o:['Respondents','Underlying factors/dimensions','Data sets','Hypotheses'],c:[1],e:'Factor Analysis is a dimensionality reduction technique that identifies latent factors underlying correlations among many observed variables.'},
      {q:'Turnitin primarily checks for:',o:['Grammar errors','Code plagiarism','Textual similarity/plagiarism','Citation format'],c:[2],e:'Turnitin compares submitted text against a massive database of academic works and websites to detect textual similarity and potential plagiarism.'},
      {q:'The concept of "Zone of Proximal Development" (ZPD) belongs to:',o:['Piaget','Vygotsky','Bruner','Ausubel'],c:[1],e:"Lev Vygotsky's ZPD is the gap between what a learner can do independently and what they can achieve with guidance â€” the ideal teaching zone."},
    ]
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE & AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let USERS = JSON.parse(localStorage.getItem('ee_users') || '{}');
if(!USERS['student1']) USERS['student1'] = {pass:'pass123',name:'Student One',history:[],points:0,bestStreak:0};
if(!USERS['testuser']) USERS['testuser'] = {pass:'quiz456',name:'Test User',history:[],points:0,bestStreak:0};
if(!USERS['admin'])    USERS['admin']    = {pass:'admin123',name:'Admin',history:[],points:0,bestStreak:0};

let CU = null; // current user key

const S = {
  exams:[],diff:null,qCount:10,secPerQ:20,
  qs:[],idx:0,score:0,streak:0,bestStreak:0,
  ans:[],timeTaken:[],timerId:null,timeLeft:0,
  answered:false,selectedOpts:new Set()
};

function saveUsers(){ localStorage.setItem('ee_users',JSON.stringify(USERS)); }

// â”€â”€ Screens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function show(id){
  document.querySelectorAll('.screen').forEach(s=>{s.classList.remove('active');s.style.display='none'});
  const el=document.getElementById(id);
  el.style.display='block';
  requestAnimationFrame(()=>el.classList.add('active'));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  LOGIN / REGISTER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('.auth-tab').forEach(t=>{
  t.addEventListener('click',()=>{
    document.querySelectorAll('.auth-tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    document.querySelectorAll('.form-section').forEach(x=>x.classList.remove('active'));
    document.getElementById('form-'+t.dataset.tab).classList.add('active');
  });
});

document.getElementById('li-eye').addEventListener('click',()=>{
  const i=document.getElementById('li-pass');
  i.type=i.type==='password'?'text':'password';
});
document.getElementById('rg-eye').addEventListener('click',()=>{
  const i=document.getElementById('rg-pass');
  i.type=i.type==='password'?'text':'password';
});

document.querySelectorAll('.demo-chip').forEach(c=>{
  c.addEventListener('click',()=>{
    document.getElementById('li-user').value=c.dataset.u;
    document.getElementById('li-pass').value=c.dataset.p;
    document.querySelector('[data-tab="login"]').click();
  });
});

function validate(id,errId,cond,msg){
  const err=document.getElementById(errId);
  if(!cond){ err.textContent=msg; err.classList.add('show'); return false; }
  err.classList.remove('show'); return true;
}

document.getElementById('btn-login').addEventListener('click',()=>{
  const u=document.getElementById('li-user').value.trim();
  const p=document.getElementById('li-pass').value;
  let ok=true;
  ok=validate('li-user','li-user-err',u,'Please enter your username') && ok;
  ok=validate('li-pass','li-pass-err',p,'Please enter your password') && ok;
  if(!ok) return;
  const err=document.getElementById('li-main-err');
  if(USERS[u] && USERS[u].pass===p){
    err.style.display='none';
    CU=u;
    document.getElementById('li-user').value='';
    document.getElementById('li-pass').value='';
    enterDashboard();
  } else {
    err.style.display='block';
  }
});

document.getElementById('btn-register').addEventListener('click',()=>{
  const n=document.getElementById('rg-name').value.trim();
  const e=document.getElementById('rg-email').value.trim();
  const u=document.getElementById('rg-user').value.trim();
  const p=document.getElementById('rg-pass').value;
  let ok=true;
  ok=validate('rg-name','rg-name-err',n.length>=2,'Name must be at least 2 characters') && ok;
  ok=validate('rg-email','rg-email-err',/^[^@]+@[^@]+\.[^@]+$/.test(e),'Enter a valid email') && ok;
  ok=validate('rg-user','rg-user-err',u.length>=3,'Username must be 3+ characters') && ok;
  ok=validate('rg-pass','rg-pass-err',p.length>=6,'Password must be at least 6 characters') && ok;
  if(!ok) return;
  const main=document.getElementById('rg-main-err');
  if(USERS[u]){ main.textContent='âŒ Username already taken!'; main.style.display='block'; return; }
  main.style.display='none';
  USERS[u]={pass:p,name:n,email:e,history:[],points:0,bestStreak:0};
  saveUsers();
  CU=u;
  enterDashboard();
});

// allow Enter key
['li-user','li-pass'].forEach(id=>{
  document.getElementById(id).addEventListener('keydown',e=>{
    if(e.key==='Enter') document.getElementById('btn-login').click();
  });
});

document.getElementById('btn-logout').addEventListener('click',()=>{
  CU=null;
  document.getElementById('hud').classList.remove('show');
  show('s-login');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function enterDashboard(){
  const ud=USERS[CU];
  document.getElementById('hud').classList.add('show');
  document.getElementById('hud-user').textContent='ğŸ‘¤ '+ud.name;
  document.getElementById('hud-pts').textContent='âš¡ '+ud.points+' pts';
  switchTab('dash');
  show('s-dashboard');
}

function renderDashboard(){
  const ud=USERS[CU];
  document.getElementById('d-name').textContent=ud.name.split(' ')[0];
  document.getElementById('ds-total').textContent=ud.history.length;
  document.getElementById('ds-pts').textContent=ud.points;
  const accs=ud.history.map(h=>h.acc);
  document.getElementById('ds-acc').textContent=accs.length?Math.max(...accs)+'%':'â€”';
  document.getElementById('ds-streak').textContent=ud.bestStreak||0;
  renderHistory('history-list', ud.history.slice(-5).reverse());
}

function renderHistory(elId, list){
  const el=document.getElementById(elId);
  if(!list.length){ el.innerHTML='<div class="empty-state">ğŸ“­ No quizzes yet!</div>'; return; }
  el.innerHTML=list.map(h=>{
    const cls=h.acc>=80?'good':h.acc>=50?'avg':'poor';
    return `<div class="hist-item">
      <div class="hi-icon">${DB[h.exam]?.icon||'ğŸ“š'}</div>
      <div class="hi-info">
        <div class="hi-name">${DB[h.exam]?.name||h.exam} â€” ${h.diff} (${h.count} Qs)</div>
        <div class="hi-meta">${h.date} Â· ${h.correct}/${h.count} correct Â· ${h.pts} pts</div>
      </div>
      <div class="hi-score ${cls}">${h.acc}%</div>
    </div>`;
  }).join('');
}

// â”€â”€ TAB NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('main-tabs').addEventListener('click',e=>{
  if(e.target.classList.contains('nav-tab')) switchTab(e.target.dataset.s);
});
document.getElementById('btn-go-setup').addEventListener('click',()=>switchTab('setup'));

function switchTab(tab){
  ['dash','setup','stats'].forEach(t=>{
    document.getElementById('tab-'+t).style.display='none';
    document.querySelector(`[data-s="${t}"]`)?.classList.remove('active');
  });
  document.getElementById('tab-'+tab).style.display='block';
  document.querySelector(`[data-s="${tab}"]`)?.classList.add('active');
  if(tab==='dash') renderDashboard();
  if(tab==='stats') renderStats();
  if(tab==='setup') buildExamGrid();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SETUP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildExamGrid(){
  const g=document.getElementById('exam-grid');
  g.innerHTML='';
  Object.entries(DB).forEach(([key,ex])=>{
    const c=document.createElement('div');
    c.className='exam-card'+(S.exams.includes(key)?' selected':'');
    c.dataset.key=key;
    c.innerHTML=`<div class="ec-check">âœ“</div>
      <span class="ec-badge ${ex.badge}">${ex.label}</span>
      <span class="ec-icon">${ex.icon}</span>
      <div class="ec-name">${ex.name}</div>
      <div class="ec-info">${ex.desc}</div>`;
    c.addEventListener('click',()=>toggleExam(key,c));
    g.appendChild(c);
  });
  updatePreview();
}

function toggleExam(key,el){
  const i=S.exams.indexOf(key);
  if(i===-1){ S.exams.push(key); el.classList.add('selected'); }
  else { S.exams.splice(i,1); el.classList.remove('selected'); }
  updatePreview();
  document.getElementById('btn-start-quiz').disabled=(!S.exams.length||!S.diff);
}

document.querySelectorAll('.diff-card').forEach(c=>{
  c.addEventListener('click',()=>{
    document.querySelectorAll('.diff-card').forEach(x=>x.classList.remove('picked'));
    c.classList.add('picked');
    S.diff=c.dataset.d;
    updatePreview();
    document.getElementById('btn-start-quiz').disabled=(!S.exams.length||!S.diff);
  });
});

document.getElementById('qcount-row').addEventListener('click',e=>{
  if(!e.target.classList.contains('qc-btn')) return;
  document.querySelectorAll('.qc-btn').forEach(b=>b.classList.remove('active'));
  e.target.classList.add('active');
  S.qCount=parseInt(e.target.dataset.n);
  updatePreview();
});

const tSlider=document.getElementById('t-slider');
const tValBox=document.getElementById('tval-box');
function setTimerVal(v){
  S.secPerQ=parseInt(v);
  tSlider.value=S.secPerQ===0?120:S.secPerQ;
  tValBox.textContent=S.secPerQ===0?'â™¾ None':S.secPerQ+'s';
  document.querySelectorAll('.tp-btn').forEach(b=>b.classList.toggle('active',parseInt(b.dataset.t)===S.secPerQ));
  document.getElementById('pv-timer').textContent=S.secPerQ===0?'â™¾ None':S.secPerQ+'s';
}
setTimerVal(20);
tSlider.addEventListener('input',()=>setTimerVal(tSlider.value));
document.getElementById('timer-presets').addEventListener('click',e=>{
  if(e.target.classList.contains('tp-btn')) setTimerVal(e.target.dataset.t);
});

function updatePreview(){
  document.getElementById('pv-exams').textContent=S.exams.length?S.exams.map(k=>DB[k].icon).join(' ')+' '+S.exams.map(k=>DB[k].name).join(', '):'None';
  document.getElementById('pv-diff').textContent=S.diff||'â€”';
  document.getElementById('pv-count').textContent=S.qCount;
}

document.getElementById('btn-reset-setup').addEventListener('click',()=>{
  S.exams=[]; S.diff=null;
  document.querySelectorAll('.exam-card').forEach(c=>c.classList.remove('selected'));
  document.querySelectorAll('.diff-card').forEach(c=>c.classList.remove('picked'));
  document.getElementById('btn-start-quiz').disabled=true;
  updatePreview();
});

document.getElementById('btn-start-quiz').addEventListener('click',()=>{
  buildQuestions();
  initQuiz();
  show('s-quiz');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BUILD QUESTIONS â€” randomise correct position
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildQuestions(){
  const pool=[];
  S.exams.forEach(key=>{
    DB[key][S.diff].forEach(q=>pool.push({...q,examKey:key}));
  });
  // shuffle & slice
  pool.sort(()=>Math.random()-.5);
  const picked=pool.slice(0,Math.min(S.qCount,pool.length));

  // For each question, randomise the position of options
  S.qs=picked.map(q=>{
    const opts=[...q.o]; // original 4 opts
    const correctVals=q.c.map(i=>opts[i]); // correct answer texts
    // shuffle options
    const shuffled=[...opts].sort(()=>Math.random()-.5);
    // recompute correct indices
    const newCorrect=correctVals.map(v=>shuffled.indexOf(v));
    return {...q, o:shuffled, c:newCorrect};
  });

  S.idx=0; S.score=0; S.streak=0; S.bestStreak=0;
  S.ans=new Array(S.qs.length).fill(null);
  S.timeTaken=new Array(S.qs.length).fill(0);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUIZ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initQuiz(){
  // dot nav
  const dn=document.getElementById('dot-nav');
  dn.innerHTML='';
  S.qs.forEach((_,i)=>{
    const d=document.createElement('div');
    d.className='dn-dot'; d.dataset.i=i;
    d.addEventListener('click',()=>jumpTo(i));
    dn.appendChild(d);
  });
  // exam pill
  document.getElementById('qh-exam').textContent=S.exams.map(k=>DB[k].icon).join('')+' '+S.exams.map(k=>DB[k].name).join(', ');
  const dMap={easy:'ğŸŒ± Easy',mid:'âš¡ Medium',hard:'ğŸ’€ Hard'};
  document.getElementById('qh-diff').textContent=dMap[S.diff];
  loadQ();
}

function loadQ(){
  S.answered=false; S.selectedOpts=new Set();
  const q=S.qs[S.idx];
  const ex=DB[q.examKey];
  const n=S.qs.length;

  document.getElementById('q-num-lbl').textContent=`Question ${S.idx+1} of ${n}`;
  document.getElementById('q-text').textContent=q.q;

  const dtag=document.getElementById('qt-diff');
  const dCls={easy:'easy',mid:'mid',hard:'hard'};
  const dLbl={easy:'ğŸŒ± Easy',mid:'âš¡ Medium',hard:'ğŸ’€ Hard'};
  dtag.textContent=dLbl[S.diff]; dtag.className='qtag qtag-diff '+dCls[S.diff];
  document.getElementById('qt-cat').textContent=ex.icon+' '+ex.name;

  // multi-answer note
  const mn=document.getElementById('multi-note');
  mn.style.display=(q.multi)?'inline-flex':'none';

  // progress
  const pct=Math.round((S.idx/n)*100);
  document.getElementById('prog-bar').style.width=pct+'%';
  document.getElementById('pq-frac').textContent=(S.idx+1)+'/'+n;
  document.getElementById('pq-pct').textContent=pct+'%';

  // score display
  document.getElementById('qs-pts').textContent=S.score;
  document.getElementById('hud-pts').textContent='âš¡ '+S.score+' pts';
  const stkBox=document.getElementById('qs-stk-box');
  if(S.streak>=2){ stkBox.classList.remove('hidden'); document.getElementById('qs-stk').textContent=S.streak; }
  else stkBox.classList.add('hidden');

  updateDots();

  // nav
  document.getElementById('btn-qback').disabled=(S.idx===0);
  const isLast=S.idx===n-1;
  document.getElementById('btn-qnext').textContent=isLast?'Finish âœ“':'Next â†’';

  if(S.ans[S.idx]!==null){
    // already answered
    renderOpts(q,true);
    showFeedback(S.ans[S.idx]);
    showExplain(q.e);
    document.getElementById('btn-qnext').disabled=false;
    document.getElementById('btn-skip').disabled=true;
    stopTimer();
  } else {
    renderOpts(q,false);
    hideFeedback();
    hideExplain();
    document.getElementById('btn-qnext').disabled=true;
    document.getElementById('btn-skip').disabled=false;
    startTimer();
  }
}

function jumpTo(i){
  if(i===S.idx) return;
  stopTimer(); S.idx=i; loadQ();
}

function updateDots(){
  document.querySelectorAll('.dn-dot').forEach((d,i)=>{
    d.className='dn-dot';
    if(i===S.idx){ d.classList.add('cur'); return; }
    const a=S.ans[i];
    if(!a) return;
    if(a.skipped) d.classList.add('skip');
    else if(a.ok) d.classList.add('ok');
    else d.classList.add('bad');
  });
}

// â”€â”€ Render Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderOpts(q, locked){
  const container=document.getElementById('opts');
  container.innerHTML='';
  const KEYS=['A','B','C','D'];
  q.o.forEach((opt,i)=>{
    const btn=document.createElement('div');
    btn.className='opt'+(locked?' locked':'');
    btn.innerHTML=`<div class="opt-key">${KEYS[i]}</div><div class="opt-txt">${opt}</div><div class="opt-ic"></div>`;
    if(locked){
      const a=S.ans[S.idx];
      if(!a||a.skipped) return; // skip: show nothing
      const isCorrect=q.c.includes(i);
      const wasSelected=a.selected&&a.selected.includes(i);
      if(isCorrect){ btn.classList.add('correct'); btn.querySelector('.opt-ic').textContent='âœ“'; }
      else if(wasSelected&&!isCorrect){ btn.classList.add('wrong'); btn.querySelector('.opt-ic').textContent='âœ—'; }
    } else {
      btn.addEventListener('click',()=>selectOpt(i,btn,q));
    }
    container.appendChild(btn);
  });
}

function selectOpt(i,btn,q){
  if(S.answered) return;
  if(q.multi){
    // multi: toggle selection
    if(S.selectedOpts.has(i)){
      S.selectedOpts.delete(i);
      btn.classList.remove('sel');
    } else {
      S.selectedOpts.add(i);
      btn.classList.add('sel');
    }
    // enable next if at least one selected
    document.getElementById('btn-qnext').disabled=(S.selectedOpts.size===0);
    // provide a "Submit" cue (re-use Next button)
    document.getElementById('btn-qnext').textContent='Submit âœ“';
  } else {
    // single: immediate answer
    S.selectedOpts=new Set([i]);
    submitAnswer(q);
  }
}

// For multi: Next/Submit triggers this
function submitAnswer(q){
  if(S.answered) return;
  S.answered=true;
  stopTimer();
  if(S.secPerQ>0){
    const elapsed=Math.max(0,S.secPerQ-S.timeLeft);
    S.timeTaken[S.idx]=elapsed;
  }
  const selected=[...S.selectedOpts];
  const ok=q.c.length===selected.length && q.c.every(ci=>selected.includes(ci));
  let pts=0;
  if(ok){
    const ratio=S.secPerQ>0?S.timeLeft/S.secPerQ:1;
    const base={easy:80,mid:120,hard:200}[S.diff];
    pts=Math.max(20,Math.round(ratio*base));
    S.score+=pts; S.streak++; S.bestStreak=Math.max(S.bestStreak,S.streak);
    if(S.streak>=3) showStreakToast(S.streak);
  } else {
    S.streak=0;
  }
  S.ans[S.idx]={ok,selected,correct:q.c,pts,skipped:false};
  // reveal options
  renderOpts(q,true);
  showFeedback(S.ans[S.idx],q,pts);
  showExplain(q.e);
  document.getElementById('btn-qnext').disabled=false;
  document.getElementById('btn-skip').disabled=true;
  const isLast=S.idx===S.qs.length-1;
  document.getElementById('btn-qnext').textContent=isLast?'Finish âœ“':'Next â†’';
  document.getElementById('qs-pts').textContent=S.score;
  document.getElementById('hud-pts').textContent='âš¡ '+S.score+' pts';
  updateDots();
}

// â”€â”€ SKIP â€” no answer shown, just move â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('btn-skip').addEventListener('click',()=>{
  if(S.answered) return;
  stopTimer();
  S.timeTaken[S.idx]=0;
  S.ans[S.idx]={ok:false,selected:[],correct:S.qs[S.idx].c,pts:0,skipped:true};
  S.streak=0;
  hideFeedback(); hideExplain();
  document.getElementById('btn-qnext').disabled=false;
  document.getElementById('btn-skip').disabled=true;
  const isLast=S.idx===S.qs.length-1;
  document.getElementById('btn-qnext').textContent=isLast?'Finish âœ“':'Next â†’';
  updateDots();
  // auto move to next (with brief delay)
  setTimeout(()=>{
    if(S.idx<S.qs.length-1){ S.idx++; loadQ(); }
    else finishQuiz();
  },300);
});

// Back / Next
document.getElementById('btn-qback').addEventListener('click',()=>{
  if(S.idx===0) return;
  stopTimer(); S.idx--; loadQ();
});

document.getElementById('btn-qnext').addEventListener('click',()=>{
  const q=S.qs[S.idx];
  // if multi and not yet answered, treat as submit
  if(q.multi && !S.answered && S.selectedOpts.size>0){
    submitAnswer(q); return;
  }
  if(S.idx<S.qs.length-1){ stopTimer(); S.idx++; loadQ(); }
  else finishQuiz();
});

// â”€â”€ TIMER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startTimer(){
  stopTimer();
  if(S.secPerQ===0){
    document.getElementById('tbar-fill').style.width='100%';
    document.getElementById('tbar-fill').className='tbar-fill';
    document.getElementById('t-num').textContent='âˆ';
    document.getElementById('timer-box').className='timer-box';
    return;
  }
  S.timeLeft=S.secPerQ;
  window._qStart=Date.now();
  renderTimer();
  S.timerId=setInterval(()=>{
    S.timeLeft--;
    renderTimer();
    if(S.timeLeft<=0){ clearInterval(S.timerId); autoTimeout(); }
  },1000);
}
function stopTimer(){ clearInterval(S.timerId); }
function renderTimer(){
  if(S.secPerQ===0) return;
  const pct=S.timeLeft/S.secPerQ;
  const fill=document.getElementById('tbar-fill');
  const box=document.getElementById('timer-box');
  fill.style.width=(pct*100)+'%';
  document.getElementById('t-num').textContent=S.timeLeft;
  const cls=pct<=0.3?'danger':pct<=0.5?'warn':'';
  fill.className='tbar-fill'+(cls?' '+cls:'');
  box.className='timer-box'+(cls?' '+cls:'');
}
function autoTimeout(){
  if(S.answered) return;
  S.answered=true;
  const q=S.qs[S.idx];
  S.ans[S.idx]={ok:false,selected:[],correct:q.c,pts:0,skipped:false,timedOut:true};
  S.streak=0;
  renderOpts(q,true);
  const fb=document.getElementById('feedback');
  fb.className='feedback timeout show';
  fb.innerHTML=`<div class="fb-icon">â±</div><div class="fb-body"><strong>Time's up!</strong> Check the highlighted correct answer.</div>`;
  showExplain(q.e);
  document.getElementById('btn-qnext').disabled=false;
  document.getElementById('btn-skip').disabled=true;
  const isLast=S.idx===S.qs.length-1;
  document.getElementById('btn-qnext').textContent=isLast?'Finish âœ“':'Next â†’';
  updateDots();
}

// â”€â”€ FEEDBACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showFeedback(a,q,pts){
  const fb=document.getElementById('feedback');
  if(!a||a.skipped){ fb.className='feedback'; return; }
  if(a.timedOut){ return; } // already set in autoTimeout
  if(a.ok){
    fb.className='feedback ok show';
    fb.innerHTML=`<div class="fb-icon">âœ…</div><div class="fb-body"><strong>Correct! +${a.pts} pts</strong>${S.streak>=3?' ğŸ”¥ '+S.streak+'Ã— Streak!':''}</div>`;
  } else {
    const q2=S.qs[S.idx];
    const correctStr=a.correct.map(ci=>q2.o[ci]).join(' / ');
    fb.className='feedback bad show';
    fb.innerHTML=`<div class="fb-icon">âŒ</div><div class="fb-body"><strong>Wrong!</strong> Correct: <strong>${correctStr}</strong></div>`;
  }
}
function hideFeedback(){ document.getElementById('feedback').className='feedback'; }
function showExplain(text){
  const eb=document.getElementById('explain-box');
  document.getElementById('explain-text').textContent=text;
  eb.classList.add('show');
}
function hideExplain(){ document.getElementById('explain-box').classList.remove('show'); }

// â”€â”€ STREAK TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showStreakToast(n){
  const t=document.getElementById('streak-toast');
  document.getElementById('stk-msg').textContent=n+'Ã— Streak! ğŸ”¥';
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),2200);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FINISH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function finishQuiz(){
  stopTimer();
  // fill any unanswered
  S.qs.forEach((_,i)=>{
    if(!S.ans[i]) S.ans[i]={ok:false,selected:[],correct:S.qs[i].c,pts:0,skipped:true};
  });

  const n=S.qs.length;
  const cor=S.ans.filter(a=>a.ok).length;
  const wrg=S.ans.filter(a=>!a.ok&&!a.skipped).length;
  const skp=S.ans.filter(a=>a.skipped).length;
  const acc=Math.round((cor/n)*100);

  // save to user history
  const ud=USERS[CU];
  ud.points=(ud.points||0)+S.score;
  ud.bestStreak=Math.max(ud.bestStreak||0,S.bestStreak);
  const rec={
    exam:S.exams[0]||'mixed', exams:S.exams,
    diff:S.diff, count:n, correct:cor, wrong:wrg, skipped:skp,
    acc, pts:S.score,
    date:new Date().toLocaleDateString('en-IN',{day:'2-digit',month:'short',year:'numeric'}),
    perExam:{}
  };
  // per-exam breakdown
  S.exams.forEach(k=>{
    const ea=S.ans.filter((_,i)=>S.qs[i].examKey===k);
    const ec=ea.filter(a=>a.ok).length;
    rec.perExam[k]={total:ea.length,correct:ec,acc:ea.length?Math.round(ec/ea.length*100):0};
  });
  ud.history.push(rec);
  saveUsers();
  document.getElementById('hud-pts').textContent='âš¡ '+ud.points+' pts';

  showResults(cor,wrg,skp,acc);
}

function showResults(cor,wrg,skp,acc){
  // hero
  let emoji,title,sub;
  if(acc===100){emoji='ğŸ†';title='Perfect Score!';sub='Flawless performance â€” every answer correct!'}
  else if(acc>=80){emoji='ğŸ‰';title='Outstanding!';sub='Excellent work â€” you know your stuff!'}
  else if(acc>=60){emoji='ğŸ‘';title='Well Done!';sub='Solid performance. Keep it up!'}
  else if(acc>=40){emoji='ğŸ“–';title='Keep Learning!';sub='Study the explanations and try again!'}
  else{emoji='ğŸ’ª';title='Don\'t Give Up!';sub='Review the answers below and retry!'}
  document.getElementById('rh-emoji').textContent=emoji;
  document.getElementById('rh-title').innerHTML=`<em>${title}</em>`;
  document.getElementById('rh-sub').textContent=sub;
  document.getElementById('ring-pct').textContent=acc+'%';
  document.getElementById('acc-txt').textContent=acc+'%';
  document.getElementById('r-cor').textContent=cor;
  document.getElementById('r-wrg').textContent=wrg;
  document.getElementById('r-skp').textContent=skp;
  document.getElementById('r-pts').textContent=S.score;

  // ring
  const ring=document.getElementById('ring-fg');
  const circ=376.99;
  const col=acc>=80?'var(--green)':acc>=50?'var(--amber)':'var(--red)';
  ring.style.stroke=col;
  ring.style.strokeDashoffset=circ;
  setTimeout(()=>{ ring.style.strokeDashoffset=circ-(circ*acc/100); },300);
  setTimeout(()=>{ document.getElementById('acc-fill').style.width=acc+'%'; },300);

  // breakdown
  const bdList=document.getElementById('bd-list');
  bdList.innerHTML='';
  S.exams.forEach(k=>{
    const ex=DB[k];
    const ea=S.ans.filter((_,i)=>S.qs[i].examKey===k);
    const ec=ea.filter(a=>a.ok).length;
    const ep=ea.length?Math.round(ec/ea.length*100):0;
    const brow=document.createElement('div');
    brow.className='bd-row';
    brow.innerHTML=`<div class="bd-icon">${ex.icon}</div>
      <div class="bd-info">
        <div class="bd-name">${ex.name}</div>
        <div class="bd-bar"><div class="bd-fill" style="width:0%;background:${ep>=80?'var(--green)':ep>=50?'var(--amber)':'var(--red)'}" data-p="${ep}"></div></div>
      </div>
      <div class="bd-score">${ec}/${ea.length} (${ep}%)</div>`;
    bdList.appendChild(brow);
  });
  setTimeout(()=>{ document.querySelectorAll('.bd-fill').forEach(b=>{b.style.transition='width 1.1s cubic-bezier(.4,0,.2,1)';b.style.width=b.dataset.p+'%'}); },400);

  // review
  const rvItems=document.getElementById('rv-items');
  rvItems.innerHTML='';
  S.ans.forEach((a,i)=>{
    const q=S.qs[i];
    const ex=DB[q.examKey];
    const cls=a.ok?'ok':a.skipped?'skip':'bad';
    const badge=a.ok?'âœ“ Correct':a.skipped?'âš¡ Skipped':'âœ— Wrong';
    let ansLine='';
    if(a.skipped){
      ansLine=`<span>Skipped</span> â†’ Correct: <span class="ca">${a.correct.map(ci=>q.o[ci]).join(' / ')}</span>`;
    } else if(a.ok){
      ansLine=`Your answer: <span class="ca">${a.selected.map(si=>q.o[si]).join(' / ')}</span>`;
    } else {
      ansLine=`Your: <span class="wa">${a.selected.length?a.selected.map(si=>q.o[si]).join(' / '):'â€”'}</span> â†’ Correct: <span class="ca">${a.correct.map(ci=>q.o[ci]).join(' / ')}</span>`;
    }
    const rv=document.createElement('div');
    rv.className=`rv ${cls}`;
    rv.innerHTML=`<div class="rv-top"><span class="rv-badge">${badge}</span><span class="rv-meta">${ex.icon} ${ex.name} Â· Q${i+1}</span></div>
      <div class="rv-q">${q.q}</div>
      <div class="rv-ans">${ansLine}</div>
      <div class="rv-explain">ğŸ’¡ ${q.e}</div>`;
    rvItems.appendChild(rv);
  });

  // review toggle
  document.getElementById('rv-hdr').classList.remove('open');
  rvItems.classList.remove('open');

  if(acc>=70) spawnConfetti();
  show('s-result');
}

document.getElementById('rv-hdr').addEventListener('click',()=>{
  document.getElementById('rv-hdr').classList.toggle('open');
  document.getElementById('rv-items').classList.toggle('open');
});

document.getElementById('ra-retry').addEventListener('click',()=>{
  buildQuestions(); initQuiz(); show('s-quiz');
});
document.getElementById('ra-newsetup').addEventListener('click',()=>{
  switchTab('setup'); show('s-dashboard');
});
document.getElementById('ra-dash').addEventListener('click',()=>{
  switchTab('dash'); show('s-dashboard');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATISTICS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderStats(){
  const ud=USERS[CU];
  const h=ud.history;
  document.getElementById('so-total').textContent=h.length;
  document.getElementById('so-pts').textContent=ud.points||0;
  const avgs=h.map(x=>x.acc);
  document.getElementById('so-avg').textContent=avgs.length?Math.round(avgs.reduce((a,b)=>a+b,0)/avgs.length)+'%':'â€”';

  // per exam performance
  const pg=document.getElementById('perf-grid');
  pg.innerHTML='';
  Object.entries(DB).forEach(([key,ex])=>{
    const exH=h.filter(x=>x.exams&&x.exams.includes(key));
    if(!exH.length) return;
    const avAcc=Math.round(exH.reduce((s,x)=>s+(x.perExam[key]?.acc||0),0)/exH.length);
    const col=avAcc>=80?'var(--green)':avAcc>=50?'var(--amber)':'var(--red)';
    const card=document.createElement('div');
    card.className='perf-card';
    card.innerHTML=`<div class="pc-label">${ex.icon} ${ex.name}</div>
      <div class="pc-val" style="color:${col}">${avAcc}%</div>
      <div style="font-size:.68rem;color:var(--sub);margin-bottom:.4rem">${exH.length} attempt${exH.length>1?'s':''}</div>
      <div class="pc-bar"><div class="pc-fill" style="background:${col};width:${avAcc}%"></div></div>`;
    pg.appendChild(card);
  });
  if(!pg.children.length) pg.innerHTML='<div class="empty-state" style="grid-column:1/-1">No exam data yet</div>';

  // leaderboard (all users sorted by points)
  const lb=document.getElementById('leaderboard');
  const allUsers=Object.entries(USERS).map(([k,v])=>({key:k,name:v.name,pts:v.points||0,quizzes:v.history.length}));
  allUsers.sort((a,b)=>b.pts-a.pts);
  lb.innerHTML=allUsers.slice(0,6).map((u,i)=>{
    const rankCls=i===0?'gold':i===1?'silver':i===2?'bronze':'';
    const rankIco=i===0?'ğŸ¥‡':i===1?'ğŸ¥ˆ':i===2?'ğŸ¥‰':'#'+(i+1);
    const isMe=u.key===CU?'style="border-color:var(--acc2)"':'';
    return `<div class="lb-row" ${isMe}>
      <div class="lb-rank ${rankCls}">${rankIco}</div>
      <div class="lb-name">${u.name}${u.key===CU?' ğŸ‘ˆ':''}</div>
      <div class="lb-score">${u.pts} pts</div>
      <div class="lb-badge">${u.quizzes} quiz${u.quizzes!==1?'zes':''}</div>
    </div>`;
  }).join('');
  if(!lb.innerHTML) lb.innerHTML='<div class="empty-state">No data yet</div>';

  // recent history
  renderHistory('stats-history', h.slice(-8).reverse());
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONFETTI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function spawnConfetti(){
  const layer=document.getElementById('cf-layer');
  layer.innerHTML='';
  const cols=['#5b6af0','#8b5cf6','#10d97e','#fbbf24','#ff4d6d','#38bdf8','#f472b6'];
  for(let i=0;i<80;i++){
    const p=document.createElement('div');
    p.className='cf-p';
    p.style.cssText=`left:${Math.random()*100}vw;top:0;background:${cols[i%cols.length]};
      width:${6+Math.random()*8}px;height:${6+Math.random()*8}px;
      border-radius:${Math.random()>.5?'50%':'2px'};
      animation-duration:${2+Math.random()*3}s;animation-delay:${Math.random()*1.5}s`;
    layer.appendChild(p);
  }
  setTimeout(()=>layer.innerHTML='',7000);
}
</script>
</body>
</html>